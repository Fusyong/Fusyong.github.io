<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>嬉戏实验室 - 14 效率工具+编程杂项</title>
    <meta name="description" content="">
    <meta name="author" content="黄复雄">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/theme/bootstrap.min.css" rel="stylesheet">
    <link href="/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="/theme/local.css" rel="stylesheet">
    <link href="/theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="/">嬉戏实验室</a>
        <div class="nav-collapse">
        <ul class="nav">

            <li><a href="http://www.xiiigame.com">XiiiGame</a></li>
           
            <li><a href="/pages/about.html">About</a></li>
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
        

        


    <div class='article'>
        <div class="content-title">
            <a href="/ying-pan-sun-pi-qiang-jiu-shu-ju.html"><h1>硬盘损坏，抢救数据</h1></a>
2020-09-26 周六

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 
        </div>
        
        <div><p>上两周坏了一个硬盘。——这还是第一次把硬盘用坏。虽然此前20天备份过一次，可想到要重做这二十天的工，很是沮丧。好在经过两三天的尝试，全部恢复了。现记录如下。</p>
<h2 id="_1">前兆</h2>
<p>大概两三个月前，有天晚上关机着急，没等主机关闭就关了点。结果导致固态C盘损坏。换盘，重装了系统。这跟今次硬盘损坏大概没有关系，存疑。</p>
<p>这次D盘损坏前大概两三周，<strong>一个正在操作的问题突然报出无法找到。到所在位置去看，文件夹打不开了。用win10自带的磁盘“差错”工具处理后，在根目录隐藏文件夹<code>found.000</code>中找到了恢复的文件夹和文件。</strong></p>
<p>这大概就是一个前兆，但当时没太在意，没有备份文件。</p>
<h2 id="_2">磁盘崩溃过程</h2>
<p>当天写笔记，编译为html时突然报刚才写的文件找不到，紧接着<strong>很多文件都无法找到。然后win10系统卡死，无法正常关机。</strong></p>
<p>关电重启后报系统检查错误（具体记不清了），很久无进展。</p>
<p>再关电重启，停留在主板logo页面，下面的圈长久不停。</p>
<p>以上两种状态常交替出现。</p>
<h2 id="_3">拆下硬盘能正常启动</h2>
<p><strong>拆下D盘后能正常启动。</strong></p>
<p>买了一个硬盘底座，连接后，用各种磁盘工具、数据恢复工具都无法处理，多半卡死。</p>
<p>硬盘底座有个硬盘对拷的功能，不知道工作原理，尝试了一下，很久没看到进展，就没敢再用。</p>
<h2 id="uubuntu">用U盘Ubuntu制作启动盘</h2>
<p>根据<a href="https://www.cgsecurity.org/wiki/Damaged_Hard_Disk">这个网页</a>的提示，制作了一个U盘的Ubuntu系统。——这个网页推荐Knoppix LiveCD系统，但我不熟悉。</p>
<p>具体制作方法可以看<a href="https://ubuntu.com/tutorials/create-a-usb-stick-on-windows#10-installation-complete">这个简单教程</a>。主要包括两步：</p>
<ol>
<li>安装Rufus；</li>
<li>用一个U盘制作Ubuntu系统，也就是直接用U盘启动、运行，不需要安装的系统。Rufus很容易用，只看这里的设置就可以：</li>
</ol>
<p><img alt="refus" src="https://ubuntucommunity.s3.dualstack.us-east-2.amazonaws.com/original/2X/d/df720a52ca05eb8348856590a6ffc1c1ab27e8ac.png"></p>
<h2 id="ubuntu">启动Ubuntu，安装软件</h2>
<p>做好后插在电脑上，准备启动。<strong>最好只留下问题盘和一张容量等于或大于问题盘的空磁盘（用于存储恢复的数据），sata连接，其余的全部拆除，以免误操作。</strong></p>
<p>把启动时更改biso的引导顺序，通过刚才的U盘引导。<strong>启动后不要操作问题盘和存储数据用的盘，不要装载！以免出问题。</strong></p>
<p>进入Ubuntu系统后先添加国内的程序源，以便安装程序。也就是在源文件<code>/etc/apt/sources.list</code>后添加源列表。比如阿里源：</p>
<div class="highlight"><pre><span></span><code>deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
</code></pre></div>


<p>然后更新系统：</p>
<div class="highlight"><pre><span></span><code>sudo apt-get update
sudo apt-get upgrade
</code></pre></div>


<p><strong>安装<code>gddrescue</code>。注意软件包名字前有个g，但是命令没有g，只是<code>ddrescue</code>。</strong></p>
<div class="highlight"><pre><span></span><code>sudo apt-get install gddrescue
</code></pre></div>


<p>还可以安装通过图形查看进度的工具<code>ddrescueview</code>：</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install ddrescueview
</code></pre></div>


<h2 id="ddrescue">使用<code>ddrescue</code>复制、抢救数据</h2>
<p>先查看磁盘列表：</p>
<div class="highlight"><pre><span></span><code>lshw -C disk
</code></pre></div>


<p>或者：</p>
<div class="highlight"><pre><span></span><code>fdisk -l
</code></pre></div>


<p><img alt="磁盘信息.jpg" src="/images/硬盘损坏，抢救数据/磁盘信息.jpg"></p>
<p>磁盘通常显示为<code>/dev/sda</code>, <code>/dev/sdb</code>这样的格式。其下后还可能显示分卷，如<code>/dev/sda1</code>，<code>/dev/sda1</code>。<strong>下面处理时，应该操作整盘，而不是分卷。</strong></p>
<p><a href="https://www.gnu.org/software/ddrescue/manual/ddrescue_manual.html">这里是ddrecue的手册</a>，详细解释了算法和处理过程，有助于你在漫长的等待过程中免于焦虑。</p>
<p>ddrescue有很多选项，但我们通常只需要两个步骤。</p>
<p><strong>第一步，</strong>快速抓取大部分无错区域：</p>
<div class="highlight"><pre><span></span><code>sudo ddrescue -n -f /dev/问题盘 /dev/存储盘 rescued.log
</code></pre></div>


<p><strong>注意，选项<code>-f</code>意味着存储盘上的内容会被覆盖。</strong></p>
<p><code>rescued.log</code>是记录进度的文件。如果临时停止，<strong>重新开始后，ddrescue可以根据这个文件接着做。U盘系统重启后会丢失用户文件，所以这个文件应该通过在线邮箱等方式妥善保存。</strong></p>
<p>可以使用ddrescueview查看进度（可以用<code>-r 30s</code>这样的选项来设置刷新间隔）：</p>
<div class="highlight"><pre><span></span><code>sudo ddrescueview rescued.log
</code></pre></div>


<p>效果如下：</p>
<p><img alt="图形信息.jpg" src="/images/硬盘损坏，抢救数据/图形信息.jpg"></p>
<p><strong>我的问题盘是1T容量，数据大概900G，完成第一步耗时近6小时。</strong></p>
<p><img alt="结果信息.jpg" src="/images/硬盘损坏，抢救数据/结果信息.jpg"></p>
<p><strong>第二步，</strong>尝试从有错区域中“刮取”，也就是最大限度地恢复数据：</p>
<div class="highlight"><pre><span></span><code>sudo ddrescue -r <span class="m">1</span> /dev/old_disk /dev/new_disk rescued.log
</code></pre></div>


<p>选项<code>-r 1</code>表示重复次数。这个步骤很耗时，如果时间允许重复两三次也是可以的。这一步我只做了一小会儿。拆下来发现绝大多数已经恢复，就不再做了。</p>
<h2 id="win10">使用win10磁盘工具查错</h2>
<p>复制得到的磁盘是有错误的，我使用win10磁盘工具查错后，在根目录的隐藏文件夹<code>found.000</code>中找到了很多恢复的文件、文件夹。再通过TC，过滤时间后，得到未备份的内容，加到备份中。
（可能ddrescueview有相应的除错工具，我没有注意到。）</p>
<p><strong>后来使用文件时，发现个别文件看起来正常，但无法打开。所以，重要文件最好逐一打开看看。</strong></p>
<p>赶紧买了个4T的硬盘，所有文件都备份在这里。还重新打开谷歌硬盘，<strong>把重要文件和最近正处理的文件备份到网上。</strong>问题盘暂时还留着，后面如果再发现问题，还可以更精细地处理。</p></div>
        <hr />
    </div>


 
        

 

    <div class='article'>
        <a href="/gei-bian-ji-peng-you-de-zheng-ze-biao-da-shi-ke-cheng.html"><h2>给编辑朋友的正则表达式课程</h2></a>
        <div class= "well small"> 2020-06-13 周六

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>很多编辑只会用Word。有些编辑也会用WPS，不过他以为自己是在用Word。如果一个编辑希望稍微进一步学点“电脑知识”，我推荐学正则表达式。再搭配使用高效的文本处理工具，比如EmEditor、TextPro、VSCode、PowerGrep、Libreoffice Writer，以及一些文档管理工具，比如Total Commander、Everything，那你就可以说是编辑界的极客了。据说中华书局的很多青年编辑都会正则表达式，并自称为正则青年。其实每个人都能学会。</p> <a href="/gei-bian-ji-peng-you-de-zheng-ze-biao-da-shi-ke-cheng.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/pygame-zerowen-dang-de-si-wei-dao-tu-he-ru-men-shi-li.html"><h2>Pygame Zero文档的思维导图和入门实例</h2></a>
        <div class= "well small"> 2019-11-23 周六

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>我认为Python + Pygame Zero + Thonny是最好的少儿编程入门技术路线。今天把Pygame Zero v1.2的文档，结合源码分析，整理成思维导图和入门实例，看起来真的很简单。又梳理API的详细用法，整理成一个“一文通”的示例。</p> <a href="/pygame-zerowen-dang-de-si-wei-dao-tu-he-ru-men-shi-li.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/pythonkou-tou-shan.html"><h2>Python口头禅</h2></a>
        <div class= "well small"> 2019-05-15 周三

	by 		<a class="url fn" href="/author/tim-peters.html">Tim Peters.</a>
		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>《Python之禅》是2004年的Python改进提案。禅诗、偈颂的形式。</p> <a href="/pythonkou-tou-shan.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/xiao-gong-ju-fen-ge-wen-ben-wen-jian.html"><h2>小工具：分割文本文件</h2></a>
        <div class= "well small"> 2018-12-15 周六

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>如果你想以特定格式的行（用正则表达式表示）为界，把一批<strong>文本文件</strong>分割成小片段，比如每章节或每卷一个文件，可以使用下面的Python脚本。</p> <a href="/xiao-gong-ju-fen-ge-wen-ben-wen-jian.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/auditionji-qiao-ban-zi-dong-fen-qie-yin-pin.html"><h2>Audition技巧：半自动分切音频</h2></a>
        <div class= "well small"> 2018-12-14 周五

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>在做电子书时，我需要把几百个生字朗读音频逐字分切开，把课文朗读音频逐句分切成开；或者获取每个分切位置的时间标签。总之是根据停顿静音进行分切的。此类要求可以通过Audition的“诊断”功能实现。</p> <a href="/auditionji-qiao-ban-zi-dong-fen-qie-yin-pin.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/auditionji-qiao-shi-liang-duan-bu-tong-huan-jing-de-lu-yin-xie-diao-yi-zhi.html"><h2>Audition技巧：使两段不同环境的录音协调一致</h2></a>
        <div class= "well small"> 2018-12-14 周五

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>在修补音频时，有时修补材料的录音环境有所改变，或者语音演播人改变了。如果变化不大，可以通过Audition分析、比较频率，然后根据差异调整均衡，使修补材料的音色更接近要修补的音频。调整后截取片段用于修补，能更为协调。</p> <a href="/auditionji-qiao-shi-liang-duan-bu-tong-huan-jing-de-lu-yin-xie-diao-yi-zhi.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/xiao-gong-ju-cong-duo-wen-jian-zhong-shou-ji-zi-fu-chuan.html"><h2>小工具：从多文件中收集字符串</h2></a>
        <div class= "well small"> 2018-12-12 周三

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>如果你想从很多<strong>文本文件</strong>中把一定格式的字符串收集在一起，可以使用下面的Python脚本。</p> <a href="/xiao-gong-ju-cong-duo-wen-jian-zhong-shou-ji-zi-fu-chuan.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/qi-ji-yin-qiao-zhi.html"><h2>奇技淫巧志</h2></a>
        <div class= "well small"> 2018-11-07 周三

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>本人琢磨教育学习技术问题，学习数字技术和尝试开发的日志。在这里写出来，有一点隐秘舞台的气氛，是默坐出神和盲动入迷之间的左顾右盼。</p> <a href="/qi-ji-yin-qiao-zhi.html">read...</a></div>
    </div>	
				

 
        

 

    <div class='article'>
        <a href="/jing-tai-wang-zhan-sheng-cheng-qi-pelicanxue-xi-bi-ji.html"><h2>静态网站生成器Pelican学习笔记</h2></a>
        <div class= "well small"> 2018-10-14 周日

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


 </div>
        <div class="summary"><p>不写是不行的。写微信、微博像在村头赤身裸体，彼此都尴尬。写博客是无中心的世界里守株待兔，带点暧昧情绪。尝试了几种静态文件生成器，基于Python语言的Pelican最简单、亲切。这是学习<a href="http://docs.getpelican.com/en/stable/index.html">pelican 文档</a>时随手所记的，备查。</p> <a href="/jing-tai-wang-zhan-sheng-cheng-qi-pelicanxue-xi-bi-ji.html">read...</a></div>
    </div>	
				
<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr;</a></li>

    <li class="active"><a href="/category/14-xiao-lu-gong-ju-bian-cheng-za-xiang.html">1</a></li>
    <li class=""><a href="/category/14-xiao-lu-gong-ju-bian-cheng-za-xiang2.html">2</a></li>

    <li class="next"><a href="/category/14-xiao-lu-gong-ju-bian-cheng-za-xiang2.html">&rarr;</a></li>

</ul>
</div>
 
  
        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="/archives.html">所有文章</a>
                <li><a href="/tags.html">分组标签</a>




            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                <li><a href="/category/11-bu-kao-si-ji.html">11 布考斯基</a></li>
                <li><a href="/category/12-phaserxue-xi-zhong-xin-zu.html">12 Phaser学习中心组</a></li>
                <li><a href="/category/13-pyo.html">13 Pyo</a></li>
                <li><a href="/category/14-xiao-lu-gong-ju-bian-cheng-za-xiang.html">14 效率工具+编程杂项</a></li>
                <li><a href="/category/21-er-tong-shi-zi.html">21 儿童识字</a></li>
                <li><a href="/category/22-qin-zi-xie-zi.html">22 亲子写字</a></li>
                <li><a href="/category/23-qin-zi-ban-xue.html">23 亲子伴学</a></li>
                   
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Links
                </li>

                <li>微信公众号“黄复雄”(xiiiGame):</li>
                <div align="center"><img src="http://blog.xiiigame.com/images/about/qrCodeXiiigame.jpg" /></div> 

                <li>《拼字》微信小游戏:</li>
                <div align="center"><img src="http://blog.xiiigame.com/images/about/qrCode.jpg" /></div> 

                <li><a href="http://www.xiiigame.com/example">拼字游戏(网页版)</a></li>
            </ul>
            </div>


            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                <li><a href="https://github.com/Fusyong">GitHub</a></li>
                <li><a href="https://www.phaser-china.com/">Phaser小站</a></li>
            </ul>
            </div>
            </div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="">嬉戏实验室</a> &copy; 黄复雄 2020, Powered by <a href="http://getpelican.com/">Pelican</a></p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="/theme/bootstrap-collapse.js"></script>
<script>var _gaq=[['_setAccount','UA-105243279-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
<a href="https://github.com/Fusyong"><img style="position: absolute; top: 40px; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
 
</body>
</html>