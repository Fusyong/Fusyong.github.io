<!DOCTYPE html>
<html lang="chinese (simplified)">
<head>
    <meta charset="utf-8">
    <title>嬉戏实验室 - Phaser官网实例学习笔记</title>
    <meta name="description" content="">
    <meta name="author" content="黄复雄">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/theme/bootstrap.min.css" rel="stylesheet">
    <link href="/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="/theme/local.css" rel="stylesheet">
    <link href="/theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="/">嬉戏实验室</a>
        <div class="nav-collapse">
        <ul class="nav">

            <li><a href="http://www.xiiigame.com">XiiiGame</a></li>
            
            <li><a href="/pages/about.html">About</a></li>
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>Phaser官网实例学习笔记</h1>
2017-08-18 周五

	by 		<a class="url fn" href="/author/huang-fu-xiong.html">黄复雄.</a>
 


        </div>
	
        <div>
<h2 id="_1">说明：</h2>
<ol>
<li>这是我学习Phaser2官网实例的笔记，对快速了解Phaser2能做什么、API概貌也许有帮助。<a href="http://blog.xiiigame.com/phaser3xue-xi-bi-ji.html">Phaser3学习笔记在这里。</a></li>
<li>阅读本文前，您需要对Phaser的场景结构有大致了解。笔记只摘录了关键语句，加了少量注释；语句不完整、不连续；为便于字面理解，有些类实例名称调整得更接近类名。</li>
<li>可以根据实例名称从<a href="http://phaser.io/examples">Phaser官网</a>搜出实例来细读，还可以在<a href="http://phaserchains.boniatillo.com/">PhaserChains</a>中查找语句中关键字的API文档和相关实例源码。 </li>
<li>有些类别我没有看或粗粗看过，包括GAMES（9个完整游戏），DEMOSCENE（水波、星空、旋转、渐变色等演示场景）， CREATE（像素画、渐变、多边形三个生成工具及使用实例），两个物理系统P2 PHYSICS和NINJA PHYSICS，几个付费插件BOX2D、PARTICLE STORM、VIRTUAL JOYSTICK；其余类别共有517个实例都看了，340个实例做了摘录。</li>
<li>官网是按字母排列类别的，现为初学者学习、理解方便重新排序。</li>
</ol>
<hr/>
<h2 id="basics">BASICS：基础</h2>
<h3 id="01-load-an-image">01 Load An Image</h3>
<p>载入图像到缓存</p>
<div class="highlight"><pre><span></span><span class="c1">//事后通过key值einstein来使用它。如果不是在preload场景中载入文件，还需要判断载入完成才能使用</span>
<span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'einstein'</span><span class="p">,</span> <span class="s1">'assets/pics/ra_einstein.png'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="02-click-on-an-image">02 Click On An Image</h3>
<p>用图像生成sprite，并添加点击事件监听器</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s1">'einstein'</span><span class="p">);</span>  <span class="c1">//einstein是载入图像时指定的key</span>
<span class="nx">image</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">image</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">listener</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">listener</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">//do something</span>
<span class="p">}</span>
</pre></div>
<h3 id="03-move-an-image">03 Move An Image</h3>
<p>给sprite添加运动/速度</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>  <span class="c1">//赋予sprite物理性质</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">x</span><span class="o">=</span><span class="mi">150</span><span class="p">;</span>  <span class="c1">//x轴每秒150点</span>
</pre></div>
<h3 id="04-image-follow-input">04 Image Follow Input</h3>
<p>使sprite跟随输入热点（鼠标/触点）移动</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">update</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">//  判断sprite到点的距离</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">distanceToPointer</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//  使sprite向输入热点移动</span>
        <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">moveToPointer</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="c1">//  停止</span>
        <span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//在render场景中实时显示输入信息</span>
<span class="kd">function</span> <span class="nx">render</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">inputInfo</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="05-load-an-animation">05 Load An Animation</h3>
<p>载入JSON Hash格式的图集(可用Texture Packer或Shoebox等工具生成)，生成动画</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlasJSONHash</span><span class="p">(</span><span class="s1">'bot'</span><span class="p">,</span> <span class="s1">'assets/sprites/running_bot.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/running_bot.json'</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//  生成sprite</span>
    <span class="kd">var</span> <span class="nx">bot</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'bot'</span><span class="p">);</span>
    <span class="c1">//  生成动画run（使用图集中的所有帧）</span>
    <span class="nx">bot</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'run'</span><span class="p">);</span>
    <span class="c1">//  循环播放动画run</span>
    <span class="nx">bot</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'run'</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="06-render-text">06 Render Text</h3>
<p>渲染文本</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="s2">"- phaser -\n with a sprinkle of \n pixi dust."</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"65px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#ff0044"</span><span class="p">,</span> <span class="nx">align</span><span class="o">:</span> <span class="s2">"center"</span> <span class="p">};</span> <span class="c1">//文本样式</span>
<span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>  <span class="c1">//添加文本控件</span>
</pre></div>
<h3 id="07-tween-an-image">07 Tween An Image</h3>
<p>给图像添加tween动画</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">tween</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>
<span class="c1">//  设置参与动画的属性、时长、类型等</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">to</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">800</span> <span class="p">},</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">'Linear'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h2 id="sprites">SPRITES：精灵</h2>
<h3 id="add-an-image">Add An Image</h3>
<p>通过载入的图像生成、添加image</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'pic'</span><span class="p">,</span> <span class="s1">'assets/pics/acryl_bladerunner.png'</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//与sprite相比，image没有动画和物理属性</span>
    <span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'pic'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="add-a-sprite">Add A Sprite</h3>
<p>通过载入的图像生成、添加sprite</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'mushroom'</span><span class="p">,</span> <span class="s1">'assets/sprites/mushroom2.png'</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'mushroom'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="sprite-from-bitmapdata">Sprite From Bitmapdata</h3>
<p>通过Bitmapdata生成sprite</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">'#ff0000'</span><span class="p">;</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">);</span>
</pre></div>
<h3 id="spritesheet">Spritesheet</h3>
<p>Spritesheet图单动画的用法</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'ms'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'ms'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="anchor">Anchor</h3>
<p>更改锚点</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mf">0.1</span><span class="p">;</span>
</pre></div>
<h3 id="move-a-sprite">Move A Sprite</h3>
<p>移动sprite</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="mi">4</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">y</span> <span class="o">-=</span> <span class="mi">4</span><span class="p">;</span>
</pre></div>
<h3 id="destroy">Destroy</h3>
<p>销毁精灵（以备回收）</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
<h3 id="sprite-tint">Sprite Tint</h3>
<p>罩色、染色（黑色无法再罩色，单色图像可预设成白色以方便处理）</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">tint</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mh">0xffffff</span><span class="p">;</span>
</pre></div>
<h3 id="scale-a-sprite">Scale A Sprite</h3>
<p>调整尺寸</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="nx">rand</span><span class="p">,</span> <span class="nx">rand</span><span class="p">);</span>
<span class="c1">//  或者如下：</span>
<span class="c1">//  sprite.scale.x = value;</span>
<span class="c1">//  sprite.scale.y = value;</span>
</pre></div>
<h3 id="fixed-scale">Fixed Scale</h3>
<p>设定尺寸变化范围（以免父级变化造成过度影响）</p>
<div class="highlight"><pre><span></span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'disk'</span><span class="p">);</span>
<span class="nx">child</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'ball'</span><span class="p">);</span>
<span class="nx">parent</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">child</span><span class="p">);</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">setScaleMinMax</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">scale</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">3</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Linear</span><span class="p">.</span><span class="nx">None</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="rotate-and-scale">Rotate And Scale</h3>
<p>旋转和尺寸</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">angle</span><span class="o">:</span> <span class="mi">45</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Linear</span><span class="p">.</span><span class="nx">None</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">scale</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Linear</span><span class="p">.</span><span class="nx">None</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">//sprite.angle += 1;</span>
</pre></div>
<h3 id="add-several-sprites">Add Several Sprites</h3>
<p>加载多个sprite/spriteSheet</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
</pre></div>
<h3 id="child-sprites">Child Sprites</h3>
<p>sprite加载子级sprite</p>
<div class="highlight"><pre><span></span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'mushroom'</span><span class="p">);</span>
<span class="nx">parent</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="s1">'mummy'</span><span class="p">));</span>
<span class="nx">parent</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'mummy'</span><span class="p">));</span>
<span class="nx">parent</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'mummy'</span><span class="p">));</span>
<span class="nx">child</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'mummy'</span><span class="p">));</span>
</pre></div>
<h3 id="sprite-bounds">Sprite Bounds</h3>
<p>定位框</p>
<div class="highlight"><pre><span></span><span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="nx">sprite1</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">.</span><span class="nx">centerX</span><span class="p">;</span>
<span class="nx">sprite2</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">.</span><span class="nx">centerX</span><span class="p">;</span>
<span class="nx">sprite3</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">.</span><span class="nx">centerX</span><span class="p">;</span>
</pre></div>
<h3 id="out-of-bounds">Out Of Bounds</h3>
<p>离开舞台事件</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">checkWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onOutOfBounds</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">spriteOut</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span> <span class="c1">//spriteOut是事件要调用的函数</span>
</pre></div>
<h3 id="align-in-rectangle">Align In Rectangle</h3>
<p>对齐矩形内边</p>
<div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nx">rect</span><span class="o">:</span><span class="nx">Rectangle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="nx">sprite1</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">rect</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">TOP_LEFT</span><span class="p">);</span>
<span class="nx">sprite2</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">rect</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">TOP_CENTER</span><span class="p">);</span>
<span class="nx">sprite3</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">rect</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">BOTTOM_RIGHT</span><span class="p">);</span>
</pre></div>
<h3 id="align-to-rectangle">Align To Rectangle</h3>
<p>对齐矩形（外边）</p>
<div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nx">rect</span><span class="o">:</span><span class="nx">Rectangle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
<span class="nx">sprite1</span><span class="p">.</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">rect</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">TOP_CENTER</span><span class="p">);</span>
<span class="nx">sprite2</span><span class="p">.</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">rect</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">BOTTOM_RIGHT</span><span class="p">);</span>
<span class="nx">sprite3</span><span class="p">.</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">rect</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">LEFT_CENTER</span><span class="p">);</span>
</pre></div>
<h3 id="align-multiple-sprites">Align Multiple Sprites</h3>
<p>对齐多个sprite</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">sprite1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="s1">'block'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sprite2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'block'</span><span class="p">).</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_CENTER</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sprite3</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'block'</span><span class="p">).</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite2</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_CENTER</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sprite4</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'block'</span><span class="p">).</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite3</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_CENTER</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sprite5</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'block'</span><span class="p">).</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite4</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_CENTER</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sprite6</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'block'</span><span class="p">).</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite5</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_CENTER</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
</pre></div>
<h3 id="align-text-to-sprite">Align Text To Sprite</h3>
<p>text与sprite对齐</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"32px Courier"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#00ff44"</span> <span class="p">};</span>
<span class="kd">var</span> <span class="nx">sprite1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="s1">'pic'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">text1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Phaser"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">text2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"2.4.9"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">text3</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Aligning Text"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_TOP</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_CENTER</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="nx">text3</span><span class="p">.</span><span class="nx">alignTo</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RIGHT_BOTTOM</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
</pre></div>
<h3 id="align-within-sprite">Align Within Sprite</h3>
<p>与sprite内边对齐</p>
<div class="highlight"><pre><span></span><span class="nx">pic</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">bounds</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">CENTER</span><span class="p">);</span>
<span class="nx">sprite1</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">pic</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">BOTTOM_RIGHT</span><span class="p">);</span>
<span class="nx">sprite2</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">pic</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">BOTTOM_LEFT</span><span class="p">);</span>
<span class="nx">sprite3</span><span class="p">.</span><span class="nx">alignIn</span><span class="p">(</span><span class="nx">pic</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">TOP_CENTER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
<h3 id="collide-world-bounds">Collide World Bounds</h3>
<p>碰撞世界的边界</p>
<div class="highlight"><pre><span></span><span class="nx">pineapple</span><span class="p">.</span><span class="nx">enableBody</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">pineapple</span><span class="p">.</span><span class="nx">physicsBodyType</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">;</span>
<span class="nx">pineapple</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="nx">pineapple</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">);</span>
</pre></div>
<h3 id="dynamic-crop">Dynamic Crop</h3>
<p>矩形剪切sprite</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'trsi'</span><span class="p">);</span>
<span class="nx">cropRect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">crop</span><span class="p">(</span><span class="nx">cropRect</span><span class="p">);</span>
<span class="c1">//如果需要实时更新，可在update场景中添加sprite.updateCrop(); //见### Horizontal Crop</span>
</pre></div>
<h3 id="mask">Mask</h3>
<p>sprite/group遮罩</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'chaos'</span><span class="p">);</span>
<span class="c1">// 遮罩要是Graphics对象（图像遮罩可用BitmapData.alphaMask()）</span>
<span class="kd">let</span> <span class="nx">mask</span><span class="o">:</span><span class="nx">Graphics</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">graphics</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">mask</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">);</span>
<span class="nx">mask</span><span class="p">.</span><span class="nx">drawCircle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">mask</span> <span class="o">=</span> <span class="nx">mask</span><span class="p">;</span>
</pre></div>
<h3 id="overlap-tween-without-physics">Overlap Tween Without Physics</h3>
<p>非物理学重叠/交错检测</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">checkOverlap</span><span class="p">(</span><span class="nx">spriteA</span><span class="p">,</span> <span class="nx">spriteB</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">boundsA</span> <span class="o">=</span> <span class="nx">spriteA</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">boundsB</span> <span class="o">=</span> <span class="nx">spriteB</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">.</span><span class="nx">intersects</span><span class="p">(</span><span class="nx">boundsA</span><span class="p">,</span> <span class="nx">boundsB</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="pivot">Pivot</h3>
<p>旋转的轴心</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">pivot</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">pivot</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//rotation是弧度，略快；angle是角的度数，可以是正或负，超过360度则取超出部分</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">+=</span> <span class="mf">0.05</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="rope">Rope</h3>
<p>绳索效果</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'snake'</span><span class="p">,</span> <span class="s1">'assets/sprites/snake.png'</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="mi">918</span> <span class="o">/</span> <span class="mi">20</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">points</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">i</span> <span class="o">*</span> <span class="nx">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="nx">rope</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">rope</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s1">'snake'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">points</span><span class="p">);</span>
    <span class="nx">rope</span><span class="p">.</span><span class="nx">updateAnimation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">count</span> <span class="o">+=</span> <span class="mf">0.1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">i</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="nx">count</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>
</pre></div>
<h3 id="shared-sprite-textures">Shared Sprite Textures</h3>
<p>分用图集材质</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'atlas'</span><span class="p">,</span> <span class="s1">'assets/pics/texturepacker_test.png'</span><span class="p">,</span> <span class="s1">'assets/pics/texturepacker_test.json'</span><span class="p">);</span>
<span class="nx">chick</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">'atlas'</span><span class="p">);</span>
<span class="c1">//  设置帧名</span>
<span class="nx">chick</span><span class="p">.</span><span class="nx">frameName</span> <span class="o">=</span> <span class="s1">'budbrain_chick.png'</span><span class="p">;</span>
<span class="c1">//  或设置帧号</span>
<span class="c1">//chick.frame = 0;</span>
</pre></div>
<h2 id="arcade-physicsarcade">ARCADE PHYSICS：ARCADE物理引擎</h2>
<h3 id="body-enable">Body Enable</h3>
<p>关闭body属性即取消运动和碰撞检测</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">enable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
<h3 id="gravity">Gravity</h3>
<p>重力</p>
<div class="highlight"><pre><span></span><span class="nx">sprite3</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">gravity</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="nx">sprite4</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">allowGravity</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
<h3 id="bounce">Bounce</h3>
<p>反弹</p>
<div class="highlight"><pre><span></span><span class="nx">image</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'flyer'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">image</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="nx">image</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
<span class="c1">//  与世界边界碰撞</span>
<span class="nx">image</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//  反弹能量（ "1"即100%）</span>
<span class="nx">image</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
<h3 id="bounce-accelerator">Bounce Accelerator</h3>
<p>反弹加速度</p>
<div class="highlight"><pre><span></span><span class="nx">flyer</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">acceleration</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="nx">flyer</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">acceleration</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="nx">flyer</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
</pre></div>
<h3 id="body-debug">Body Debug</h3>
<p>sprite物理学Body的调式信息</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">bodyInfo</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">body</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>
</pre></div>
<h3 id="circle-body">Circle Body</h3>
<p>圆形物体</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">enable</span><span class="p">([</span><span class="nx">disk</span><span class="p">,</span> <span class="nx">ball1</span><span class="p">,</span> <span class="nx">ball2</span><span class="p">]);</span>
<span class="c1">//  缺省情况下圆形物体碰撞边界也是方形，现设碰撞边界为直径45的圆形体</span>
<span class="nx">ball1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">setCircle</span><span class="p">(</span><span class="mi">45</span><span class="p">);</span>
<span class="nx">ball2</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">setCircle</span><span class="p">(</span><span class="mi">45</span><span class="p">);</span>
</pre></div>
<h3 id="global-pause">Global Pause</h3>
<p>物理系统全局暂停</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">isPaused</span>
</pre></div>
<h3 id="asteroids-movement">Asteroids Movement</h3>
<p>爆破彗星运动，朝向旋转角度（即正向）的加速度</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">accelerationFromRotation</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">rotation</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">acceleration</span><span class="p">);</span>
</pre></div>
<h3 id="angle-to-pointer">Angle To Pointer</h3>
<p>指向输入点的角度</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">angleToPointer</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>
</pre></div>
<h3 id="multi-angle-to-pointer">Multi Angle To Pointer</h3>
<p>角度指向热点</p>
<div class="highlight"><pre><span></span><span class="nx">sprite1</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">angleToPointer</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">);</span>
</pre></div>
<h3 id="angle-between">Angle Between</h3>
<p>两个sprite间连线的角度</p>
<div class="highlight"><pre><span></span><span class="nx">target</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">target</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="c1">// 在update中</span>
<span class="nx">arrow</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">angleBetween</span><span class="p">(</span><span class="nx">arrow</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
</pre></div>
<h3 id="angular-acceleration">Angular Acceleration</h3>
<p>角加速度</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">angularAcceleration</span> <span class="o">-=</span> <span class="mi">200</span><span class="p">;</span>
</pre></div>
<h3 id="angular-velocity">Angular Velocity</h3>
<p>角速度</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">angularVelocity</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span>
</pre></div>
<h3 id="accelerate-to-pointer">Accelerate To Pointer</h3>
<p>向点加速（一次）</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">startSystem</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">'arrow'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="c1">//  不用物理学系统管理旋转</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">allowRotation</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="c1">//在update中</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">moveToPointer</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</pre></div>
<h3 id="direct-body-movement">Direct Body Movement</h3>
<p>重叠检测</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">overlap</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">sprite2</span><span class="p">,</span> <span class="nx">overlapHandler</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="distance-to-pointer">Distance To Pointer</h3>
<p>显示对象到热点的距离</p>
<div class="highlight"><pre><span></span><span class="c1">//Phaser.Physics.Arcade.distanceToPointer(displayObject, pointer) : number; //pointer缺省为Input.activePointer</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">distanceToPointer</span><span class="p">(</span><span class="nx">displayObject</span><span class="p">)</span>
</pre></div>
<h3 id="gravity-and-drag">Gravity And Drag</h3>
<p>重力与拖拽</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStart</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">startDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">stopDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">startDrag</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//  拖拽时应禁止物理运动</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">moves</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">stopDrag</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//  停止拖拽时再打开物理运动</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">moves</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="group-vs-group">Group Vs Group</h3>
<p>组对组</p>
<div class="highlight"><pre><span></span><span class="nx">veggies</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">veggies</span><span class="p">.</span><span class="nx">enableBody</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">veggies</span><span class="p">.</span><span class="nx">physicsBodyType</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">veggies</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomX</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">'veggies'</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">integerInRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">));</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'veg'</span> <span class="o">+</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">immovable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">bullets</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">bullets</span><span class="p">.</span><span class="nx">enableBody</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bullets</span><span class="p">.</span><span class="nx">physicsBodyType</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">bullets</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'bullet'</span><span class="p">);</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'bullet'</span> <span class="o">+</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">exists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">visible</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">checkWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onOutOfBounds</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">resetBullet</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">//因为不需要处理速度等问题，这里用overlap检测而不是碰撞检测</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">overlap</span><span class="p">(</span><span class="nx">bullets</span><span class="p">,</span> <span class="nx">veggies</span><span class="p">,</span> <span class="nx">collisionHandler</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="group-vs-self">Group Vs Self</h3>
<p>组对自身</p>
<div class="highlight"><pre><span></span><span class="nx">sprites</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">physicsGroup</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="p">......</span>
<span class="nx">sprites</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="s1">'body.collideWorldBounds'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">sprites</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="s1">'body.bounce.x'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nx">sprites</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="s1">'body.bounce.y'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//自身内部的碰撞检测</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">sprites</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="larger-bounding-box">Larger Bounding Box</h3>
<p>更大的边框（检测边界）</p>
<div class="highlight"><pre><span></span><span class="nx">sprite1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</pre></div>
<h3 id="offset-bounding-box">Offset Bounding Box</h3>
<p>调整、偏置边框</p>
<div class="highlight"><pre><span></span><span class="c1">//  检测框大小100x50，偏移位置为50, 25</span>
<span class="nx">sprite1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
</pre></div>
<h3 id="move-over-distance">Move Over Distance</h3>
<p>移动一定距离</p>
<div class="highlight"><pre><span></span><span class="c1">//  （时间，距离，方位）</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">ANGLE_RIGHT</span><span class="p">);</span>
<span class="c1">// sprite.body.stopVelocityOnCollide = false;</span>
<span class="c1">// sprite.body.moveTo(Phaser.ANGLE_RIGHT, 2000, 400);</span>
<span class="c1">// sprite.body.moveFrom(2000, 100, Phaser.ANGLE_RIGHT);</span>
<span class="c1">// sprite.body.moveFrom(2000, 100, 300);</span>
</pre></div>
<h3 id="move-to-pointer">Move To Pointer</h3>
<p>向热点移动</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">moveToPointer</span><span class="p">(</span><span class="nx">ball</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="c1">// game.physics.arcade.moveToPointer(ball, 100, game.input.activePointer, 1000);</span>
</pre></div>
<h3 id="move-towards-object">Move Towards Object</h3>
<p>组向点移动</p>
<div class="highlight"><pre><span></span><span class="nx">balls</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">moveToPointer</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
</pre></div>
<h3 id="multiball">Multiball</h3>
<p>成组控制</p>
<div class="highlight"><pre><span></span><span class="nx">balls</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">balls</span><span class="p">.</span><span class="nx">createMultiple</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="s1">'bullets'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">atari</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="s1">'atari'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">gravity</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
<span class="c1">//  对目前world中的所有对象开启物理学，true表示下层对象同样适用</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="on-collide-event">On Collide Event</h3>
<p>碰撞事件</p>
<div class="highlight"><pre><span></span><span class="c1">//   通常我们这样处理碰撞事件Phaser.Physics.arcade.collide(object1, object2, collideCallback, processCallback, callbackContext) : boolean;不过也可以使用信号：</span>
<span class="nx">face1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">onCollide</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Signal</span><span class="p">();</span>
<span class="nx">face1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">onCollide</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">hitSprite</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//  仍需要在update中调用 `collide`，并仍能调用其他函数。</span>
<span class="kd">function</span> <span class="nx">update</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">face1</span><span class="p">,</span> <span class="nx">face2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="one-way-collision">One Way Collision</h3>
<p>单向碰撞检测（取消某个方向的检测）</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">checkCollision</span><span class="p">.</span><span class="nx">up</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">checkCollision</span><span class="p">.</span><span class="nx">down</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
<h3 id="process-callback">Process Callback</h3>
<p>处理调用</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">sprite2</span><span class="p">,</span> <span class="nx">collisionCallback</span><span class="p">,</span> <span class="nx">processCallback</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">processCallback</span> <span class="p">(</span><span class="nx">obj1</span><span class="p">,</span> <span class="nx">obj2</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//  此函数额外检测对象属性，以决定是否执行调用（通过返回true或false）</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">obj1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">speed</span> <span class="o">&gt;</span> <span class="nx">obj2</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">speed</span><span class="p">){</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;}</span>
<span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="kc">false</span><span class="p">;}}</span>
</pre></div>
<h3 id="quadtree-collision-infos">Quadtree Collision Infos</h3>
<p>四叉树碰撞信息</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">startSystem</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">skipQuadTree</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="c1">//在render中</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">quadTree</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">quadTree</span><span class="p">);</span>
</pre></div>
<h3 id="sort-direction">Sort Direction</h3>
<p>分类指标（没明白）</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">sortDirection</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">Arcade</span><span class="p">.</span><span class="nx">RIGHT_LEFT</span><span class="p">;</span>
</pre></div>
<h3 id="sprite-vs-group">Sprite Vs Group</h3>
<p>精灵Sprite和物理组physicsGroup</p>
<div class="highlight"><pre><span></span><span class="nx">group</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">physicsGroup</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">between</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">770</span><span class="p">),</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">between</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">570</span><span class="p">),</span> <span class="s1">'veggies'</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">between</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">));</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">mass</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="world-bounds-event">World Bounds Event</h3>
<p>与游戏世界碰撞的事件</p>
<div class="highlight"><pre><span></span><span class="nx">face</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//  缺省情况下这个信号是空的</span>
<span class="nx">face</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">onWorldBounds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Signal</span><span class="p">();</span>
<span class="c1">//  然后监听事件</span>
<span class="nx">face</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">onWorldBounds</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">hitWorldBounds</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h2 id="input">INPUT：输入</h2>
<h3 id="bounds-rect">Bounds Rect</h3>
<p>限制框</p>
<div class="highlight"><pre><span></span><span class="nx">bounds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">boundsRect</span> <span class="o">=</span> <span class="nx">bounds</span><span class="p">;</span>
</pre></div>
<h3 id="bounds-sprite">Bounds Sprite</h3>
<p>限制在精灵范围内</p>
<div class="highlight"><pre><span></span><span class="nx">bounds</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s1">'pic'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">boundsSprite</span> <span class="o">=</span> <span class="nx">bounds</span><span class="p">;</span>
</pre></div>
<h3 id="bring-a-child-to-top">Bring A Child To Top</h3>
<p>拖拽时带到顶层</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">images</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getKeys</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Cache</span><span class="p">.</span><span class="nx">IMAGE</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">pick</span><span class="p">(</span><span class="nx">images</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">tempSprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomY</span><span class="p">,</span> <span class="nx">img</span><span class="p">);</span>
<span class="nx">tempSprite</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//Phaser.Sprite.input.enableDrag(lockCenter, bringToTop, pixelPerfect, alphaThreshold, boundsRect, boundsSprite) : void;</span>
<span class="nx">tempSprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="button-destroy">Button Destroy</h3>
<p>销毁按钮</p>
<div class="highlight"><pre><span></span><span class="c1">//许多对象有pendingDestroy方法，指令下一次update时销毁，适用于从对象的调用函数内部销毁对象自身，比如有关按钮或其他输入事件方面</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">pendingDestroy</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
<h3 id="cursor-key-movement">Cursor Key Movement</h3>
<p>用方向键控制运动</p>
<div class="highlight"><pre><span></span><span class="nx">cursors</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">createCursorKeys</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">cursors</span><span class="p">.</span><span class="nx">up</span><span class="p">.</span><span class="nx">isDown</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">cursors</span><span class="p">.</span><span class="nx">up</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">+=</span> <span class="mf">0.05</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="custom-candidate-handler">Custom Candidate Handler</h3>
<p>（不明白）</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">setInteractiveCandidateHandler</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="down-duration">Down Duration</h3>
<p>按键时长</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">onUp</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">getTime</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">getTime</span><span class="p">(</span><span class="nx">pointer</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">// lastDuration = pointer.timeUp - pointer.timeDown;</span>
<span class="nx">lastDuration</span> <span class="o">=</span> <span class="nx">pointer</span><span class="p">.</span><span class="nx">duration</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="drag">Drag</h3>
<p>拖拽</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//  Phaser.Sprite.input.enableDrag(lockCenter, bringToTop, pixelPerfect, alphaThreshold, boundsRect, boundsSprite) : void;</span>
<span class="c1">// 参数'true'是对象中心对齐输入点/鼠标</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="drag-event-parameters">Drag Event Parameters</h3>
<p>拖拽事件参数</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'grid'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">group</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">inputEnableChildren</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">atari</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'atari'</span><span class="p">);</span>
<span class="nx">atari</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">atari</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">atari</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStart</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDragStart</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">atari</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDragStop</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sonic</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'sonic'</span><span class="p">);</span>
<span class="nx">sonic</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">sonic</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">sonic</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStart</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDragStart</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">sonic</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDragStop</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">onChildInputDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDown</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="drag-update">Drag Update</h3>
<p>拖拽更新事件</p>
<div class="highlight"><pre><span></span><span class="c1">//与拖拽同时更新</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragUpdate</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">dragUpdate</span><span class="p">);</span>
</pre></div>
<h3 id="drop-limitation">Drop Limitation</h3>
<p>放下时限定对齐</p>
<div class="highlight"><pre><span></span><span class="c1">//Phaser.Sprite.input.enableSnap(snapX, snapY, onDrag, onRelease, snapOffsetX, snapOffsetY) : void;</span>
<span class="c1">// 开启对齐，当释放时</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableSnap</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// 进一步处理</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onDragStop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">fixLocation</span><span class="p">);</span>
</pre></div>
<h3 id="gamepad">Gamepad</h3>
<p>游戏手柄支持，手柄相关实例还有：</p>
<p>GAMEPAD ANALOG BUTTON
GAMEPAD BUTTONS
GAMEPAD DEBUG
GAMEPAD HOTKEYS
GAMEPAD MULTIPLE PADS</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">gamepad</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
<span class="c1">// 支持四个手柄，即padX的X在1-4之间</span>
<span class="nx">pad1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">gamepad</span><span class="p">.</span><span class="nx">pad1</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">pad1</span><span class="p">.</span><span class="nx">isDown</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Gamepad</span><span class="p">.</span><span class="nx">XBOX360_DPAD_LEFT</span><span class="p">)</span> <span class="o">||</span> <span class="nx">pad1</span><span class="p">.</span><span class="nx">axis</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Gamepad</span><span class="p">.</span><span class="nx">XBOX360_STICK_LEFT_X</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">x</span><span class="o">--</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="group-input-events">Group Input Events</h3>
<p>组（成员）输入事件</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">inputEnableChildren</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">onChildInputDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDown</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">onChildInputOver</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onOver</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">onChildInputOut</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onOut</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">onDown</span> <span class="p">(</span><span class="nx">sprite</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">text</span> <span class="o">=</span> <span class="s2">"onDown: "</span> <span class="o">+</span> <span class="nx">sprite</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">tint</span> <span class="o">=</span> <span class="mh">0x00ff00</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="ignore-child-input">Ignore Child Input</h3>
<p>忽略成员的输入</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">inputEnableChildren</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">ignoreChildInput</span> <span class="o">=</span> <span class="p">(</span><span class="nx">group</span><span class="p">.</span><span class="nx">ignoreChildInput</span><span class="p">)</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
<h3 id="input-child-priority">Input Child Priority</h3>
<p>成员的输入优先序号</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">closeButton</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">pw</span><span class="p">,</span> <span class="o">-</span><span class="nx">ph</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">);</span>
<span class="nx">closeButton</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">closeButton</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">priorityID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">closeButton</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">closeWindow</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//  把"closeButton"加入弹窗中</span>
<span class="nx">popup</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">closeButton</span><span class="p">);</span>
</pre></div>
<h3 id="input-order">Input Order</h3>
<p>输入/渲染序号</p>
<div class="highlight"><pre><span></span><span class="c1">//未加人工干预时，后加入的后渲染（renderOrderID大），在上层，先收到输入（priorityID大）</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">renderOrderID</span><span class="p">;</span>
<span class="c1">//调整输入序号，见### Input Priority</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">priorityID</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
<h3 id="key">Key</h3>
<p>键盘按键</p>
<div class="highlight"><pre><span></span><span class="nx">upKey</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKey</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">UP</span><span class="p">);</span>
<span class="nx">downKey</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKey</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">DOWN</span><span class="p">);</span>
<span class="nx">leftKey</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKey</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">LEFT</span><span class="p">);</span>
<span class="nx">rightKey</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKey</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">RIGHT</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">upKey</span><span class="p">.</span><span class="nx">isDown</span><span class="p">)</span>
<span class="c1">//等效于：</span>
<span class="c1">//if (game.input.keyboard.isDown(Phaser.Keyboard.UP))</span>
<span class="p">{</span>
    <span class="nx">sprite</span><span class="p">.</span><span class="nx">y</span><span class="o">--</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="keyboard-hotkeys">Keyboard Hotkeys</h3>
<p>键盘热键</p>
<div class="highlight"><pre><span></span><span class="nx">key1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKey</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">ONE</span><span class="p">);</span>
<span class="c1">// 三种热键暂停方法：（1）移除按键捕获</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">removeKeyCapture</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">ONE</span><span class="p">);</span>
<span class="c1">//（2）如游戏在内联框架iframe或另开窗口，应通过是否获得焦点来处理，如下：</span>
<span class="c1">// game.onBlur.add(...);</span>
<span class="c1">// game.onFocus.add(...);</span>
<span class="c1">//（3）根据热点判断是否开关输入</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">withinGame</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="keyboard-justpressed">Keyboard Justpressed</h3>
<p>按键按钮多久了</p>
<div class="highlight"><pre><span></span><span class="c1">//  捕获按键，以阻止其向浏览器传播</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKeyCapture</span><span class="p">([</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">LEFT</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">RIGHT</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">SPACEBAR</span> <span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">leftKey</span><span class="p">.</span><span class="nx">isDown</span><span class="p">)</span>    <span class="p">{</span>    <span class="p">}</span>
<span class="c1">//  downDuration==true表明上次按下按键持续到如今少于250毫秒</span>
<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">leftKey</span><span class="p">.</span><span class="nx">downDuration</span><span class="p">(</span><span class="mi">250</span><span class="p">))</span> <span class="p">{</span>   <span class="p">}</span> 
</pre></div>
<h3 id="motion-lock-horizontal">Motion Lock Horizontal</h3>
<p>锁定为横向拖拽（禁用纵向拖拽）</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">allowVerticalDrag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="c1">//  禁用横向拖拽，见### Motion Lock Vertical</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">allowHorizontalDrag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
<h3 id="mouse-buttons">Mouse Buttons</h3>
<p>鼠标按键</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">capture</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"Left Button: "</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">leftButton</span><span class="p">.</span><span class="nx">isDown</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">132</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"Middle Button: "</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">middleButton</span><span class="p">.</span><span class="nx">isDown</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">196</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"Right Button: "</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">rightButton</span><span class="p">.</span><span class="nx">isDown</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">260</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="multi-touch">Multi Touch</h3>
<p>多点触控</p>
<div class="highlight"><pre><span></span><span class="c1">//缺省为两点，增加第三点：</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">addPointer</span><span class="p">();</span>
<span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">pointer</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">mousePointer</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">pointer</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">pointer1</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">pointer</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">pointer2</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">pointer</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">pointer3</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="on-tap">On Tap</h3>
<p>点击事件</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">onTap</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onTap</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">onTap</span><span class="p">(</span><span class="nx">pointer</span><span class="p">,</span> <span class="nx">doubleTap</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">doubleTap</span><span class="p">)</span>    <span class="p">{</span>    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="out-of-game">Out Of Game</h3>
<p>判断鼠标/触控热点是否立刻游戏窗口</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">withinGame</span><span class="p">){</span>  <span class="p">}</span>
</pre></div>
<h3 id="override-default-controls">Override Default Controls</h3>
<p>覆盖缺省控制</p>
<div class="highlight"><pre><span></span><span class="c1">// 捕获按键事件，以阻止其向浏览器冒泡/继续传播</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addKeyCapture</span><span class="p">([</span>
<span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">LEFT</span><span class="p">,</span>
<span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">RIGHT</span><span class="p">,</span>
<span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">UP</span><span class="p">,</span>
<span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">DOWN</span><span class="p">,</span>
<span class="nx">Phaser</span><span class="p">.</span><span class="nx">Keyboard</span><span class="p">.</span><span class="nx">SPACEBAR</span>
<span class="p">]);</span>
</pre></div>
<h3 id="pixel-perfect-click-detection">Pixel Perfect Click Detection</h3>
<p>为悬浮事件精细检测像素（排除透明部分）</p>
<div class="highlight"><pre><span></span><span class="nx">bunny</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//  每次鼠标移动都进行检测，相当耗费资源!（可以只在点击时检测pixelPerfectClick=true）</span>
<span class="nx">bunny</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">pixelPerfectOver</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bunny</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">useHandCursor</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
<h3 id="pixelpick-atlas">Pixelpick Atlas</h3>
<p>为点击事件精细检测像素（排除透明部分）</p>
<div class="highlight"><pre><span></span><span class="nx">chick</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">chick</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">pixelPerfectClick</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">chick</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">clicked</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="pointer-lock">Pointer Lock</h3>
<p>鼠标请求点锁定（不明白）</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">requestPointerLock</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">mouse</span><span class="p">.</span><span class="nx">locked</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">click</span><span class="p">)</span>    <span class="p">{</span>        <span class="p">}</span>
</pre></div>
<h3 id="pointer-over">Pointer Over</h3>
<p>输入点悬浮检测</p>
<div class="highlight"><pre><span></span><span class="c1">// bunny.input.pixelPerfectOver = true;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">bunny</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">pointerOver</span><span class="p">())</span>    <span class="p">{</span>    <span class="p">}</span>
</pre></div>
<h3 id="snap-on-drag">Snap On Drag</h3>
<p>拖拽时、后对齐</p>
<div class="highlight"><pre><span></span><span class="c1">//  Input Enable the sprites</span>
<span class="nx">atari1</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">atari2</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//  enableDrag parameters = (lockCenter, bringToTop, pixelPerfect, alphaThreshold, boundsRect, boundsSprite)</span>
<span class="nx">atari1</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">atari2</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="c1">//  拖拽时、后对齐，网格为32x32像素</span>
<span class="nx">atari1</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableSnap</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">//  只在释放时对齐</span>
<span class="nx">atari2</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableSnap</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="virtual-gamecontroller">Virtual Gamecontroller</h3>
<p>虚拟游戏控制器（略）</p>
<h3 id="word-input">Word Input</h3>
<p>字词输入</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">addCallbacks</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">keyPress</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">keyPress</span><span class="p">(</span><span class="kr">char</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">char</span> <span class="o">===</span> <span class="nx">letter</span><span class="p">)</span>    <span class="p">{</span>    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2 id="groups">GROUPS：组</h2>
<h3 id="create-group">Create Group</h3>
<p>创建组</p>
<div class="highlight"><pre><span></span><span class="nx">yourGroup</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
</pre></div>
<h3 id="add-a-sprite-to-group">Add A Sprite To Group</h3>
<p>把sprite加入组的两种方法</p>
<div class="highlight"><pre><span></span><span class="nx">group1</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="mi">360</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">120</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'baddie'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ufo</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="s1">'ufo'</span><span class="p">);</span>
<span class="nx">group2</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">ufo</span><span class="p">);</span>
</pre></div>
<h3 id="remove-removebetween">Remove ### RemoveBetween</h3>
<p>移除</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">removeBetween</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">);</span>
<span class="c1">//group.total; 组成员数</span>
</pre></div>
<h3 id="replace">Replace</h3>
<p>替换</p>
<div class="highlight"><pre><span></span><span class="nx">item1</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">item1</span><span class="p">,</span> <span class="nx">item2</span><span class="p">);</span>
</pre></div>
<h3 id="align-frames-to-grid">Align Frames To Grid</h3>
<p>图集的帧对齐网格</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">create</span><span class="p">.</span><span class="nx">grid</span><span class="p">(</span><span class="s1">'grid'</span><span class="p">,</span> <span class="mi">160</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">160</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="s1">'rgba(0, 250, 0, 1)'</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">group</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">createMultiple</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'seacreatures'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'blueJellyfish0000'</span><span class="p">,</span> <span class="s1">'crab10000'</span><span class="p">,</span> <span class="s1">'flyingFish0000'</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">align</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">CENTER</span><span class="p">);</span>
<span class="c1">// group.align(5, 3, 160, 160, Phaser.TOP_RIGHT);</span>
<span class="c1">// group.align(5, 3, 160, 160, Phaser.BOTTOM_LEFT);</span>
</pre></div>
<h3 id="align-sprites-to-grid">Align Sprites To Grid</h3>
<p>精灵对齐网格</p>
<div class="highlight"><pre><span></span><span class="c1">//  每帧生成24个精灵</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">createMultiple</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="s1">'spritesheet'</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// sprites.createMultiple(20, ['diamonds', 'balls'], [0, 1, 2], true);</span>
<span class="c1">//  12列，每格48x48像素</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">align</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">);</span>
</pre></div>
<h3 id="bring-a-group-to-top">Bring A Group To Top</h3>
<p>移到顶层</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">bringToTop</span><span class="p">(</span><span class="nx">group2</span><span class="p">);</span>
</pre></div>
<h3 id="call-all">Call All</h3>
<p>对组中所有成员调用函数</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">callAll</span><span class="p">(</span><span class="s1">'revive'</span><span class="p">);</span>
</pre></div>
<h3 id="call-all-animations">Call All Animations</h3>
<p>全部调用动画</p>
<div class="highlight"><pre><span></span><span class="c1">//  对组中所有成员调用函数，相当于遍历</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">callAll</span><span class="p">(</span><span class="s1">'animations.add'</span><span class="p">,</span> <span class="s1">'animations'</span><span class="p">,</span> <span class="s1">'spin'</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">callAll</span><span class="p">(</span><span class="s1">'animations.play'</span><span class="p">,</span> <span class="s1">'animations'</span><span class="p">,</span> <span class="s1">'spin'</span><span class="p">);</span>
</pre></div>
<h3 id="call-all-input">Call All Input</h3>
<p>全部调用输入</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="s1">'inputEnabled'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">callAll</span><span class="p">(</span><span class="s1">'events.onInputDown.add'</span><span class="p">,</span> <span class="s1">'events.onInputDown'</span><span class="p">,</span> <span class="nx">removeCoin</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">removeCoin</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="create-if-null">Create If Null</h3>
<p>组中元素生死判断</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">getFirstDead</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">frame</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">countLiving</span><span class="p">();</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">countDead</span><span class="p">();</span>
</pre></div>
<h3 id="depth-sort">Depth Sort</h3>
<p>层次排序</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Group</span><span class="p">.</span><span class="nx">SORT_ASCENDING</span><span class="p">);</span>
</pre></div>
<h3 id="display-order">Display Order</h3>
<p>复活时保持显示层次不变</p>
<div class="highlight"><pre><span></span><span class="nx">card</span><span class="p">.</span><span class="nx">kill</span><span class="p">();</span>
<span class="c1">//  使组中元素复活，并在原来的位置显示</span>
<span class="kd">var</span> <span class="nx">deadCard</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">getFirstDead</span><span class="p">();</span>
<span class="nx">deadCard</span><span class="p">.</span><span class="nx">revive</span><span class="p">();</span>
</pre></div>
<h3 id="filter-by-property">Filter By Property</h3>
<p>根据属性筛选</p>
<div class="highlight"><pre><span></span><span class="c1">// 取得组中"key"值为"card"的第一个元素</span>
<span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="nx">items</span><span class="p">.</span><span class="nx">iterate</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'card'</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Group</span><span class="p">.</span><span class="nx">RETURN_CHILD</span><span class="p">);</span>
<span class="c1">// 更换材质</span>
<span class="nx">card</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span><span class="s1">'hotdog'</span><span class="p">);</span>
</pre></div>
<h3 id="for-each">For Each</h3>
<p>对所有成员逐个应用函数</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">);</span>
</pre></div>
<h3 id="get-first">Get First</h3>
<p>取得第一个活的成员</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">getFirstAlive</span><span class="p">();</span>
<span class="c1">//  取得第一个死的成员，见### Get First Dead</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">veg</span><span class="p">.</span><span class="nx">getFirstDead</span><span class="p">();</span>
</pre></div>
<h3 id="group-transform-rotate">Group Transform Rotate</h3>
<p>组变形、旋转等（与sprite近似）</p>
<div class="highlight"><pre><span></span><span class="nx">group</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">pivot</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">pivot</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">rotation</span> <span class="o">+=</span> <span class="mf">0.02</span><span class="p">;</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="s1">'inputEnabled'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">callAll</span><span class="p">(</span><span class="s1">'input.enableDrag'</span><span class="p">,</span> <span class="s1">'input'</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
<h3 id="set-all">Set All</h3>
<p>全部设置</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="s1">'alpha'</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">());</span>
</pre></div>
<h3 id="move-to-another-group">Move To Another Group</h3>
<p>把group1成员都移到group2</p>
<div class="highlight"><pre><span></span><span class="nx">group1</span><span class="p">.</span><span class="nx">moveAll</span><span class="p">(</span><span class="nx">group2</span><span class="p">);</span>
</pre></div>
<h3 id="nested-groups">Nested Groups</h3>
<p>组嵌套</p>
<div class="highlight"><pre><span></span><span class="nx">group1</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">group2</span><span class="p">);</span>
</pre></div>
<h3 id="recycling">Recycling</h3>
<p>成员的消灭和复活</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">killBaddie</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">baddie</span> <span class="o">=</span> <span class="nx">enemies</span><span class="p">.</span><span class="nx">getFirstAlive</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">baddie</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">baddie</span><span class="p">.</span><span class="nx">kill</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">createBaddie</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Phaser.Group.getFirstExists(exists, createIfNull, x, y, key, frame)，"exists"指示查找的是活的还是死的成员，缺省为true</span>
    <span class="kd">var</span> <span class="nx">enemy</span> <span class="o">=</span> <span class="nx">enemies</span><span class="p">.</span><span class="nx">getFirstExists</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">enemy</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">enemy</span><span class="p">.</span><span class="nx">revive</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="sort">Sort</h3>
<p>排序</p>
<div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nx">locs</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">locs</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">ArrayUtils</span><span class="p">.</span><span class="nx">shuffle</span><span class="p">(</span><span class="nx">locs</span><span class="p">);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Group</span><span class="p">.</span><span class="nx">SORT_ASCENDING</span><span class="p">);</span>
</pre></div>
<h3 id="swap-children-in-a-group">Swap Children In A Group</h3>
<p>交换组成员的索引/层次</p>
<div class="highlight"><pre><span></span><span class="c1">//世界 (World)类是扩展组类而来的</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">swap</span><span class="p">(</span><span class="nx">atari1</span><span class="p">,</span> <span class="nx">atari2</span><span class="p">);</span>
</pre></div>
<h2 id="buttons">BUTTONS：按钮</h2>
<p>按钮</p>
<div class="highlight"><pre><span></span><span class="nx">button</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">-</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">,</span> <span class="nx">actionOnClick</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="c1">//button.onInputOver.add(over, this);</span>
<span class="c1">//button.onInputOut.add(out, this);</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">onInputUp</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">up</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">up</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'button up'</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="button-in-a-group">Button In A Group</h3>
<p>按钮分组</p>
<div class="highlight"><pre><span></span><span class="nx">group</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">-</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">,</span> <span class="nx">removeGroup</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">onInputOver</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">over</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">onInputOut</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">out</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">// game.input.onDown.addOnce(removeGroup, this);</span>
<span class="nx">group</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">button</span><span class="p">);</span>
</pre></div>
<h3 id="button-using-texture-atlas">Button Using Texture Atlas</h3>
<p>使用材质图集的按钮</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'button'</span><span class="p">,</span> <span class="s1">'assets/buttons/button_texture_atlas.png'</span><span class="p">,</span> <span class="s1">'assets/buttons/button_texture_atlas.json'</span><span class="p">);</span>
<span class="nx">button</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">-</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">,</span> <span class="nx">actionOnClick</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="s1">'over'</span><span class="p">,</span> <span class="s1">'out'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">);</span>
<span class="nx">button</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span> <span class="o">-</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">,</span> <span class="nx">onUp</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="cancel-button">Cancel Button</h3>
<p>取消按钮（传送按钮属性）</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">onUp</span><span class="p">(</span><span class="nx">button</span><span class="p">,</span> <span class="nx">pointer</span><span class="p">,</span> <span class="nx">isOver</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isOver</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">background</span><span class="p">.</span><span class="nx">visible</span> <span class="o">=!</span> <span class="nx">background</span><span class="p">.</span><span class="nx">visible</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="changing-the-frames">Changing The Frames</h3>
<p>改换按钮帧</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'button'</span><span class="p">,</span> <span class="s1">'assets/buttons/number-buttons-90x90.png'</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span>
<span class="nx">button</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">button</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s1">'button'</span><span class="p">,</span> <span class="nx">actionOnClick</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">//(overFrame, outFrame, downFrame, upFrame)</span>
<span class="nx">button</span><span class="p">.</span><span class="nx">setFrames</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>
<h3 id="disable-button-on-click">Disable Button On Click</h3>
<p>停止按钮功能</p>
<div class="highlight"><pre><span></span><span class="nx">button</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
<h2 id="tweens">TWEENS：补间动画</h2>
<h3 id="alpha-text">Alpha Text</h3>
<p>文本透明度动画</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">text</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">alpha</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="chained-tweens">Chained Tweens</h3>
<p>链接动画</p>
<div class="highlight"><pre><span></span><span class="c1">//前一个动画结束时触发后一个动画（一次可链接多个）</span>
<span class="nx">tweenA</span><span class="p">.</span><span class="nx">chain</span><span class="p">(</span><span class="nx">tweenB</span><span class="p">);</span>
</pre></div>
<h3 id="combined-tweens">Combined Tweens</h3>
<p>联合动画</p>
<div class="highlight"><pre><span></span><span class="nx">pigArrives</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">pig</span><span class="p">);</span>    
<span class="nx">pigArrives</span><span class="p">.</span><span class="nx">to</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span><span class="mi">150</span><span class="p">},</span> <span class="mi">1000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">Out</span><span class="p">);</span>
<span class="c1">//通过结束事件生成、调用新的动画</span>
<span class="nx">pigArrives</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">firstTween</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="earthquake">Earthquake</h3>
<p>通过函数递归调用自身，实现动画重复播放</p>
<div class="highlight"><pre><span></span><span class="nx">addQuake</span><span class="p">();</span>
<span class="kd">function</span> <span class="nx">addQuake</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">quake</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">).</span><span class="nx">to</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">rumbleOffset</span><span class="p">},</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">InOut</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">// 结束事件触发函数自身，从而无限播放</span>
    <span class="nx">quake</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">addOnce</span><span class="p">(</span><span class="nx">addQuake</span><span class="p">);</span>
    <span class="nx">quake</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<h3 id="easing">Easing</h3>
<p>缓冲</p>
<div class="highlight"><pre><span></span><span class="nx">tween</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">item</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">245</span> <span class="p">},</span> <span class="mi">2400</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">Out</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="fading-in-a-sprite">Fading In A Sprite</h3>
<p>淡入淡出</p>
<div class="highlight"><pre><span></span><span class="c1">//透明度动画</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">alpha</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Linear</span><span class="p">.</span><span class="nx">None</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="generate-data">Generate Data</h3>
<p>预先生成动画数据（供众多对象使用）</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">tweenData</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span> <span class="p">};</span>
<span class="c1">//  使数据动起来（因为不用显示，所以用make而不是add）</span>
<span class="nx">tween</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">tweenData</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">400</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="s2">"Sine.easeInOut"</span><span class="p">);</span>
<span class="c1">//  以帧率60生成数据，对于同样的动画用于众多对象来说很有用，可预先计算数据</span>
<span class="nx">data</span> <span class="o">=</span> <span class="nx">tween</span><span class="p">.</span><span class="nx">generateData</span><span class="p">(</span><span class="mi">60</span><span class="p">);</span>
<span class="c1">//  Now create some sprites to shown the tween data in action</span>
<span class="nx">bugs</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">bugs</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="s1">'wasp'</span><span class="p">);</span>
<span class="c1">//...</span>
<span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">bugs</span><span class="p">.</span><span class="nx">getAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">bugs</span><span class="p">.</span><span class="nx">getAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">y</span><span class="p">;</span>
    <span class="c1">//...</span>
    <span class="nx">index</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h3 id="interpolation">INTERPOLATION</h3>
<p>动画插值设置</p>
<div class="highlight"><pre><span></span><span class="nx">tween</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">logo</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="p">[</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="nx">y</span><span class="o">:</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">h</span><span class="p">,</span> <span class="nx">h</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">},</span> <span class="mi">4000</span><span class="p">,</span> <span class="s2">"Sine.easeInOut"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="c1">//tween.interpolation(Phaser.Math.bezierInterpolation);</span>
<span class="c1">//tween.interpolation(Phaser.Math.catmullRomInterpolation);</span>
<span class="c1">//tween.interpolation(Phaser.Math.linearInterpolation);</span>
</pre></div>
<h3 id="pause-tween">Pause Tween</h3>
<p>动画的暂停/继续播放</p>
<div class="highlight"><pre><span></span><span class="nx">tween</span><span class="p">.</span><span class="nx">pause</span><span class="p">();</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">resume</span><span class="p">();</span>
</pre></div>
<h3 id="repeat">Repeat</h3>
<p>动画的重复</p>
<div class="highlight"><pre><span></span><span class="c1">//重播10次，重播前延迟1000毫秒</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">repeat</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</pre></div>
<h3 id="tween-from">Tween From</h3>
<p>动画到此</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s1">'phaser'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">).</span><span class="nx">from</span><span class="p">(</span> <span class="p">{</span> <span class="nx">y</span><span class="o">:</span> <span class="o">-</span><span class="mi">200</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">Out</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="single-tween-reuse">Single Tween Reuse</h3>
<p>单个动画的复用</p>
<div class="highlight"><pre><span></span><span class="nx">tween</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">addOnce</span><span class="p">(</span><span class="nx">tween2</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//  一次性事件应如上使用addOnce，否则必须先移除上面所加的事件tween.onComplete.removeAll()，否则会再次触发</span>
<span class="kd">function</span> <span class="nx">tween2</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">tween</span><span class="p">.</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">alpha</span><span class="o">:</span> <span class="mf">0.5</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">Out</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">tween</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">addOnce</span><span class="p">(</span><span class="nx">tween3</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">tween3</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">tween</span><span class="p">.</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">400</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">alpha</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">Out</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">tween</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">addOnce</span><span class="p">(</span><span class="nx">tween2</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="tween-array">Tween Array</h3>
<p>根据数组生成动画</p>
<div class="highlight"><pre><span></span><span class="nx">tween</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">to</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="nx">y</span><span class="o">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">250</span><span class="p">]</span> <span class="p">},</span> <span class="mi">3000</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">);</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</pre></div>
<h3 id="tween-loop-event">Tween Loop Event</h3>
<p>动画循环事件</p>
<div class="highlight"><pre><span></span><span class="nx">tween</span><span class="p">.</span><span class="nx">onStart</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onStart</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">onRepeat</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onLoop</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onComplete</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//关闭延迟</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="tween-relative">Tween Relative</h3>
<p>相对值动画</p>
<div class="highlight"><pre><span></span><span class="c1">//带引号的+300是相对值，意味着动画开始时的sprite.x+300</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="s1">'+300'</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Linear</span><span class="p">.</span><span class="nx">None</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="tween-several-properties">Tween Several Properties</h3>
<p>同一对象的多属性动画</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">item</span><span class="p">).</span><span class="nx">to</span><span class="p">({</span><span class="nx">y</span><span class="o">:</span> <span class="mi">240</span><span class="p">},</span> <span class="mi">2400</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Bounce</span><span class="p">.</span><span class="nx">Out</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">400</span> <span class="o">*</span> <span class="nx">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">item</span><span class="p">).</span><span class="nx">to</span><span class="p">({</span><span class="nx">angle</span><span class="o">:</span> <span class="mi">360</span><span class="p">},</span> <span class="mi">2400</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Cubic</span><span class="p">.</span><span class="nx">In</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">400</span> <span class="o">*</span> <span class="nx">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="yoyo">Yoyo</h3>
<p>往复（反向动画回到原样）</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">tween</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">sprite</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span> <span class="p">{</span> <span class="nx">alpha</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">,</span> <span class="s2">"Linear"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="c1">//  延迟3000毫秒后返回</span>
<span class="nx">tween</span><span class="p">.</span><span class="nx">yoyo</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="mi">3000</span><span class="p">);</span>
</pre></div>
<h2 id="animation">ANIMATION：动画</h2>
<h3 id="animation-events">Animation Events</h3>
<p>动画事件</p>
<div class="highlight"><pre><span></span><span class="nx">anim</span> <span class="o">=</span> <span class="nx">mummy</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">);</span>
<span class="nx">anim</span><span class="p">.</span><span class="nx">onStart</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">animationStarted</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">anim</span><span class="p">.</span><span class="nx">onLoop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">animationLooped</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">anim</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">animationStopped</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">anim</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="change-frame">Change Frame</h3>
<p>改变sprite的帧</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures_json.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures_json.json'</span><span class="p">);</span>
<span class="nx">greenJellyfish</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">330</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'greenJellyfish0000'</span><span class="p">);</span>
<span class="nx">greenJellyfish</span><span class="p">.</span><span class="nx">frameName</span> <span class="o">=</span> <span class="s1">'greenJellyfish0010'</span><span class="p">;</span>
</pre></div>
<h3 id="change-texture-on-click">Change Texture On Click</h3>
<p>改变材质</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlasJSONHash</span><span class="p">(</span><span class="s1">'bot'</span><span class="p">,</span> <span class="s1">'assets/sprites/running_bot.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/running_bot.json'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="nx">bot</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'bot'</span><span class="p">);</span>
<span class="nx">bot</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'run'</span><span class="p">);</span>
<span class="nx">bot</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'run'</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">bot</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">bot</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">);</span>
<span class="nx">bot</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="creature-dragon">Creature Dragon</h3>
<p>生物龙</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'dragonTexture'</span><span class="p">,</span> <span class="s1">'assets/creature/dragon.png'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'dragonMesh'</span><span class="p">,</span> <span class="s1">'assets/creature/dragon.json'</span><span class="p">);</span>
<span class="nx">dragon</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">creature</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="s1">'dragonTexture'</span><span class="p">,</span> <span class="s1">'dragonMesh'</span><span class="p">);</span>
<span class="nx">dragon</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="c1">//  true = loop</span>
</pre></div>
<h3 id="load-texture">Load Texture</h3>
<p>加载材质</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">creature</span>
</pre></div>
<h3 id="dynamic-animation">Dynamic Animation</h3>
<p>动态动画</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'orb'</span><span class="p">,</span> <span class="s1">'assets/sprites/orb-blue.png'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">352</span><span class="p">,</span> <span class="mi">22</span><span class="p">);</span>
<span class="c1">//  在bmd中画16次图</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">22</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">orb</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
    <span class="nx">x</span> <span class="o">+=</span> <span class="mi">22</span><span class="p">;</span>
    <span class="nx">y</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//  加入缓存，URL留空，传送bmd.canvas作为数据，尺寸22x22，帧数16</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">addSpriteSheet</span><span class="p">(</span><span class="s1">'dynamic'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">canvas</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="c1">//  生成精灵和动画</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span> <span class="o">+</span> <span class="p">(</span><span class="nx">i</span> <span class="o">*</span> <span class="mi">22</span><span class="p">),</span> <span class="s1">'dynamic'</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'float'</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'float'</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="frame-update">Frame Update</h3>
<p>帧更新事件</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">onUpdate</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onUpdate</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="group-creation">Group Creation</h3>
<p>在组中生成（没明白）</p>
<h3 id="looped-animation">Looped Animation</h3>
<p>以15fps循环播放</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'run'</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="sprite-sheet">Sprite Sheet</h3>
<p>精灵图列动画</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">mummy</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'mummy'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">walk</span> <span class="o">=</span> <span class="nx">mummy</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">);</span>
<span class="nx">mummy</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="starling-atlas">Starling Atlas</h3>
<p>分片图集动画</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlasXML</span><span class="p">(</span><span class="s1">'octopus'</span><span class="p">,</span> <span class="s1">'assets/sprites/octopus.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/octopus.xml'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">octopus</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'octopus'</span><span class="p">);</span>
<span class="nx">octopus</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'swim'</span><span class="p">);</span>
<span class="nx">octopus</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'swim'</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="stop-animation">Stop Animation</h3>
<p>停止动画</p>
<div class="highlight"><pre><span></span><span class="nx">greenJellyfish</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
<span class="c1">//  停止后重置到第一帧</span>
<span class="c1">// greenJellyfish.animations.stop(null, true);</span>
</pre></div>
<h3 id="two-frame-test">Two Frame Test</h3>
<p>两帧动画测试</p>
<div class="highlight"><pre><span></span><span class="nx">left</span> <span class="o">=</span> <span class="nx">player</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'left'</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">right</span> <span class="o">=</span> <span class="nx">player</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'right'</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'up'</span><span class="p">,</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'down'</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'left'</span><span class="p">);</span>
</pre></div>
<h2 id="particles">PARTICLES：粒子</h2>
<h3 id="auto-scale">Auto Scale</h3>
<p>自动调整尺寸</p>
<div class="highlight"><pre><span></span><span class="c1">//Phaser.Particles.Arcade.Emitter.setScale(minX, maxX, minY, maxY, rate, ease, yoyo) : Phaser.Particles.Arcade.Emitter;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">setScale</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">Quintic</span><span class="p">.</span><span class="nx">Out</span><span class="p">);</span>
</pre></div>
<h3 id="click-burst">Click Burst</h3>
<p>点击时爆炸</p>
<div class="highlight"><pre><span></span><span class="c1">//Phaser.Particles.Arcade.Emitter.start(explode, lifespan, frequency, quantity, forceQuantity) : Phaser.Particles.Arcade.Emitter;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="c1">//  不爆炸，而是每帧20颗发射，生命周期是5000毫秒，见### Diamond Burst</span>
<span class="c1">//emitter.start(false, 5000, 20);</span>
</pre></div>
<h3 id="collision">Collision</h3>
<p>粒子碰撞</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">angularDrag</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">emitter</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="destroy-emitter">Destroy Emitter</h3>
<p>销毁发射器</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
<h3 id="emitter-width">Emitter Width</h3>
<p>发射口宽度（缺省为中间一点）</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">800</span><span class="p">;</span>
</pre></div>
<h3 id="firestarter">Firestarter</h3>
<p>喷火器</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="c1">//随机使用不同火、烟的图片：[ 'fire1', 'fire2', 'fire3', 'smoke' ]</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">(</span> <span class="p">[</span> <span class="s1">'fire1'</span><span class="p">,</span> <span class="s1">'fire2'</span><span class="p">,</span> <span class="s1">'fire3'</span><span class="p">,</span> <span class="s1">'smoke'</span> <span class="p">]</span> <span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">gravity</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">setAlpha</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">setScale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>
<h3 id="flow">Flow</h3>
<p>飘/漂</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">(</span><span class="s1">'leaf'</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">minParticleSpeed</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">maxParticleSpeed</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">minParticleScale</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">maxParticleScale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">gravity</span> <span class="o">=</span> <span class="mi">250</span><span class="p">;</span>
<span class="c1">//Phaser.Particles.Arcade.Emitter.flow(lifespan, frequency, quantity, total, immediate) : Phaser.Particles.Arcade.Emitter;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">flow</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
<h3 id="no-rotation">No Rotation</h3>
<p>禁止粒子旋转</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">minRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">maxRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
<h3 id="particle-alpha">Particle Alpha</h3>
<p>粒子透明度</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">setAlpha</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">);</span>
</pre></div>
<h3 id="particle-class">Particle Class</h3>
<p>粒子类</p>
<div class="highlight"><pre><span></span><span class="c1">//  自定粒子类</span>
<span class="nx">MonsterParticle</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">game</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Particle</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">game</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getBitmapData</span><span class="p">(</span><span class="s1">'particleShade'</span><span class="p">));</span>
<span class="p">};</span>
<span class="nx">MonsterParticle</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Particle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
<span class="nx">MonsterParticle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">MonsterParticle</span><span class="p">;</span>
<span class="nx">emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">particleClass</span> <span class="o">=</span> <span class="nx">MonsterParticle</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">();</span>
</pre></div>
<h3 id="particle-scale">Particle Scale</h3>
<p>粒子尺寸</p>
<div class="highlight"><pre><span></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">minParticleScale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">maxParticleScale</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
<h3 id="rain">Rain</h3>
<p>下雨</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
<span class="c1">//发射角度</span>
<span class="c1">// emitter.angle = 30; </span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">(</span><span class="s1">'rain'</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">minParticleScale</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">maxParticleScale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">setYSpeed</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">setXSpeed</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">minRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">maxRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">emitter</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="snow">Snow</h3>
<p>下雪</p>
<div class="highlight"><pre><span></span><span class="c1">//背景发射器</span>
<span class="nx">back_emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="mi">600</span><span class="p">);</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">(</span><span class="s1">'snowflakes'</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">maxParticleScale</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">;</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">minParticleScale</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">setYSpeed</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">gravity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">minRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">maxRotation</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="c1">//中景发射器</span>
<span class="nx">mid_emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="mi">250</span><span class="p">);</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">(</span><span class="s1">'snowflakes'</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">maxParticleScale</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">;</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">minParticleScale</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">setYSpeed</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">);</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">gravity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">minRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">maxRotation</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="c1">//前景发射器</span>
<span class="nx">front_emitter</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">emitter</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">makeParticles</span><span class="p">(</span><span class="s1">'snowflakes_large'</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">maxParticleScale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">minParticleScale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">setYSpeed</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">gravity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">width</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">minRotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">maxRotation</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="c1">//改变风向</span>
<span class="c1">//changeWindDirection();</span>
<span class="c1">//启动</span>
<span class="nx">back_emitter</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="mi">14000</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="nx">mid_emitter</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="mi">12000</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
<span class="nx">front_emitter</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</pre></div>
<h3 id="when-particles-collide">When Particles Collide</h3>
<p>粒子碰撞</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">leftEmitter</span><span class="p">,</span> <span class="nx">rightEmitter</span><span class="p">,</span> <span class="nx">change</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">change</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span><span class="p">.</span><span class="nx">frame</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="nx">b</span><span class="p">.</span><span class="nx">frame</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h2 id="time">TIME：时间</h2>
<h3 id="basic-timed-event">Basic Timed Event</h3>
<p>定时事件</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">SECOND</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">fadePicture</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="basic-looped-event">BASIC LOOPED EVENT</h3>
<p>循环事件</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">loop</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">SECOND</span><span class="p">,</span> <span class="nx">updateCounter</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="basic-repeat-event">Basic Repeat Event</h3>
<p>重复事件</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">repeat</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">SECOND</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">createBall</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="custom-timer">Custom Timer</h3>
<p>自定定时器</p>
<div class="highlight"><pre><span></span><span class="nx">timer</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="nx">timer</span><span class="p">.</span><span class="nx">loop</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="nx">updateCounter</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">timer</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</pre></div>
<h3 id="elapsed-seconds">Elapsed Seconds</h3>
<p>经过的秒数</p>
<div class="highlight"><pre><span></span><span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">totalElapsedSeconds</span><span class="p">()</span>
</pre></div>
<h3 id="remove-event">Remove Event</h3>
<p>移除事件/定时器</p>
<div class="highlight"><pre><span></span><span class="c1">//  从上倒下移除</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">timerEvents</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</pre></div>
<h3 id="slow-down-time">Slow Down Time</h3>
<p>时钟调慢</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">advancedTiming</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">desiredFps</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">slowMotion</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
</pre></div>
<h2 id="text">TEXT：文本</h2>
<h3 id="text-events">Text Events</h3>
<p>文本事件</p>
<div class="highlight"><pre><span></span><span class="c1">//文本事件与精灵事件近似</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputOver</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">over</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputOut</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">out</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">down</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputUp</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">up</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//销毁，见### REMOVE TEXT</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
<h3 id="text-gradient">Text Gradient</h3>
<p>文本渐变</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">grd</span> <span class="o">=</span> <span class="nx">text</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">createLinearGradient</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">text</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="nx">grd</span><span class="p">.</span><span class="nx">addColorStop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'#8ED6FF'</span><span class="p">);</span>   
<span class="nx">grd</span><span class="p">.</span><span class="nx">addColorStop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'#004CB3'</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="nx">grd</span><span class="p">;</span>
</pre></div>
<h3 id="center-text">Center Text</h3>
<p>文本在边框中居中</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"bold 32px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#fff"</span><span class="p">,</span> <span class="nx">boundsAlignH</span><span class="o">:</span> <span class="s2">"center"</span><span class="p">,</span> <span class="nx">boundsAlignV</span><span class="o">:</span> <span class="s2">"middle"</span> <span class="p">};</span>
<span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"phaser 2.4 text bounds"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">setShadow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'rgba(0,0,0,0.5)'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">//设定文本边框为x0, y100，800x100</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">setTextBounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
</pre></div>
<h3 id="center-text-on-sprite">Center Text On Sprite</h3>
<p>文本在精灵中居中</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'pic'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"32px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#ff0044"</span><span class="p">,</span> <span class="nx">wordWrap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">wordWrapWidth</span><span class="o">:</span> <span class="nx">sprite</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">align</span><span class="o">:</span> <span class="s2">"center"</span><span class="p">,</span> <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s2">"#ffff00"</span> <span class="p">};</span>
<span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"- text on a sprite -\ndrag me"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">sprite</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">sprite</span><span class="p">.</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="word-wrap">Word Wrap</h3>
<p>单词折行</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s1">'bold 60pt Arial'</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s1">'white'</span><span class="p">,</span> <span class="nx">align</span><span class="o">:</span> <span class="s1">'left'</span><span class="p">,</span> <span class="nx">wordWrap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">wordWrapWidth</span><span class="o">:</span> <span class="mi">450</span> <span class="p">};</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s2">"phaser with a sprinkle of pixi dust"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
</pre></div>
<h3 id="text-line-spacing">Text Line Spacing</h3>
<p>文本行距</p>
<div class="highlight"><pre><span></span><span class="nx">text2</span><span class="p">.</span><span class="nx">lineSpacing</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
</pre></div>
<h3 id="text-padding">Text Padding</h3>
<p>文本内边距</p>
<div class="highlight"><pre><span></span><span class="nx">text</span><span class="p">.</span><span class="nx">padding</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
</pre></div>
<h3 id="text-reflect">Text Reflect</h3>
<p>文本镜像</p>
<div class="highlight"><pre><span></span><span class="nx">textReflect</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">"- PHASER -"</span><span class="p">);</span>
<span class="nx">textReflect</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</pre></div>
<h3 id="text-resolution">Text Resolution</h3>
<p>文本解析度</p>
<div class="highlight"><pre><span></span><span class="nx">text</span><span class="p">.</span><span class="nx">resolution</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
<h3 id="text-shadow">Text Shadow</h3>
<p>文本阴影</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">createText</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">'shadow 5'</span><span class="p">);</span>
<span class="c1">// Phaser.Text.setShadow(x, y, color, blur, shadowStroke, shadowFill) : Phaser.Text;</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">setShadow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'rgba(0,0,0,0.5)'</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>
<h3 id="text-shadow-stroke">Text Shadow Stroke</h3>
<p>文本阴影笔触(描边)</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">text1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">"Shadow Stroke"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"74px Arial Black"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#c51b7d"</span> <span class="p">});</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="s2">"#de77ae"</span><span class="p">;</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">strokeThickness</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="c1">//  只给描边上阴影</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">setShadow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"#333333"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="s2">"Shadow Fill"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"74px Arial Black"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#c51b7d"</span> <span class="p">});</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="s2">"#de77ae"</span><span class="p">;</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">strokeThickness</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="c1">//  只给填充上阴影</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">setShadow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"#333333"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text3</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="s2">"Shadow Both"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"74px Arial Black"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#c51b7d"</span> <span class="p">});</span>
<span class="nx">text3</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="s2">"#de77ae"</span><span class="p">;</span>
<span class="nx">text3</span><span class="p">.</span><span class="nx">strokeThickness</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="c1">//  缺省（描边和阴影都上阴影）</span>
<span class="nx">text3</span><span class="p">.</span><span class="nx">setShadow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"#333333"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">text4</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="s2">"Shadow None"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"74px Arial Black"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#c51b7d"</span> <span class="p">});</span>
<span class="nx">text4</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="s2">"#de77ae"</span><span class="p">;</span>
<span class="nx">text4</span><span class="p">.</span><span class="nx">strokeThickness</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="c1">// 都不上阴影（白调用啦）</span>
<span class="nx">text4</span><span class="p">.</span><span class="nx">setShadow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"#333333"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</pre></div>
<h3 id="colored-characters">Colored Characters</h3>
<p>字符上色/着色</p>
<div class="highlight"><pre><span></span><span class="c1">//  给16-24上'#ffff00'色</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">addColor</span><span class="p">(</span><span class="s1">'#ffff00'</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">addColor</span><span class="p">(</span><span class="s1">'#ffffff'</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">addColor</span><span class="p">(</span><span class="s1">'#ff00ff'</span><span class="p">,</span> <span class="mi">28</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">addColor</span><span class="p">(</span><span class="s1">'#ffffff'</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="c1">//见### Text Tint</span>
<span class="c1">// text.tint = (item.tint === 0xffffff) ? 0xff0000 : 0xffffff;</span>
</pre></div>
<h3 id="text-stroke-with-color">Text Stroke With Color</h3>
<p>给笔触/描边上色</p>
<div class="highlight"><pre><span></span><span class="c1">//给13-19字符的描边上色</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">addStrokeColor</span><span class="p">(</span><span class="s1">'#ff0000'</span><span class="p">,</span> <span class="mi">13</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">addStrokeColor</span><span class="p">(</span><span class="s1">'#000000'</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</pre></div>
<h3 id="text-tabs">Text Tabs</h3>
<p>文本制表符</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"20px Courier"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#fff"</span><span class="p">,</span> <span class="nx">tabs</span><span class="o">:</span> <span class="mi">132</span> <span class="p">};</span>
<span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s2">"Armor\tSpells\tDamage\tWeapons"</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="c1">//  调整制表符宽度</span>
<span class="c1">// text.tabs = 132;</span>
</pre></div>
<h3 id="text-tabs-from-array">Text Tabs From Array</h3>
<p>由数组生成制表文本</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"16px Courier"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#fff"</span><span class="p">,</span> <span class="nx">tabs</span><span class="o">:</span> <span class="p">[</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">80</span> <span class="p">]</span> <span class="p">};</span>
<span class="kd">var</span> <span class="nx">headings</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Damage'</span><span class="p">,</span> <span class="s1">'Speed'</span><span class="p">,</span> <span class="s1">'Notes'</span> <span class="p">];</span> <span class="c1">//可以嵌套，每行一个列表</span>
<span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">parseList</span><span class="p">(</span><span class="nx">headings</span><span class="p">);</span>
</pre></div>
<h3 id="text-with-physics">Text With Physics</h3>
<p>带物理属性的文本</p>
<div class="highlight"><pre><span></span><span class="c1">//与精灵的物理属性近似</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">enable</span><span class="p">([</span> <span class="nx">text1</span><span class="p">,</span> <span class="nx">text2</span> <span class="p">]);</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">text2</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">text1</span><span class="p">,</span> <span class="nx">text2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="extending-text">Extending Text</h3>
<p>继承/扩充文本类</p>
<div class="highlight"><pre><span></span><span class="nx">CustomText</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">game</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">game</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"65px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#ff0044"</span><span class="p">,</span> <span class="nx">align</span><span class="o">:</span> <span class="s2">"center"</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">rotateSpeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">CustomText</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
<span class="nx">CustomText</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">CustomText</span><span class="p">;</span>
<span class="nx">CustomText</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">angle</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rotateSpeed</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<h3 id="google-webfonts">Google Webfonts</h3>
<p>谷歌在线字体</p>
<div class="highlight"><pre><span></span><span class="nx">WebFontConfig</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">//  加载完成再延迟1秒后执行createText（使用字体）</span>
    <span class="nx">active</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">SECOND</span><span class="p">,</span> <span class="nx">createText</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span> <span class="p">},</span>
    <span class="nx">google</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">families</span><span class="o">:</span> <span class="p">[</span><span class="s1">'Revalia'</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">script</span><span class="p">(</span><span class="s1">'webfont'</span><span class="p">,</span> <span class="s1">'//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="bitmap-fonts">Bitmap Fonts</h3>
<p>Bitmap字体</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">bitmapFont</span><span class="p">(</span><span class="s1">'desyrel'</span><span class="p">,</span> <span class="s1">'assets/fonts/bitmapFonts/desyrel.png'</span><span class="p">,</span> <span class="s1">'assets/fonts/bitmapFonts/desyrel.xml'</span><span class="p">);</span>
<span class="nx">bmpText</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'desyrel'</span><span class="p">,</span> <span class="s1">'Phaser &amp; Pixi\nrocking!'</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
</pre></div>
<h3 id="clean-text">Clean Text</h3>
<p>清除Bitmap文本中没有字体支持的文本</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">text1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">'desyrel'</span><span class="p">,</span> <span class="nx">dirtyString</span> <span class="o">+</span> <span class="p">(</span><span class="nx">dirtyString</span><span class="p">.</span><span class="nx">length</span><span class="p">),</span> <span class="mi">32</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">cleanString</span> <span class="o">=</span> <span class="nx">text1</span><span class="p">.</span><span class="nx">cleanText</span><span class="p">(</span><span class="nx">dirtyString</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">text2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">'desyrel'</span><span class="p">,</span> <span class="nx">cleanString</span> <span class="o">+</span> <span class="p">(</span><span class="nx">cleanString</span><span class="p">.</span><span class="nx">length</span><span class="p">),</span> <span class="mi">32</span><span class="p">);</span>
</pre></div>
<h3 id="bitmapfont-drag">Bitmapfont Drag</h3>
<p>Bitmap文本拖拽</p>
<div class="highlight"><pre><span></span><span class="nx">bmpText</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'carrier_command'</span><span class="p">,</span><span class="s1">'Drag me around !'</span><span class="p">,</span><span class="mi">34</span><span class="p">);</span>
<span class="nx">bmpText</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bmpText</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">enableDrag</span><span class="p">();</span>
</pre></div>
<h3 id="bitmaptext-anchor-x">Bitmaptext Anchor X</h3>
<p>Bitmap文本锚点</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">text3</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">470</span><span class="p">,</span> <span class="s1">'desyrel'</span><span class="p">,</span> <span class="s1">'Anchor.x = 1'</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
<span class="nx">text3</span><span class="p">.</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="c1">//text3.anchor.y = 0.5; //见### Bitmaptext Anchor Y</span>
</pre></div>
<h3 id="bitmaptext-max-width">Bitmaptext Max Width</h3>
<p>Bitmap文本最大行宽</p>
<div class="highlight"><pre><span></span><span class="c1">//文本需要有空格才能自动折行</span>
<span class="nx">bmpText</span><span class="p">.</span><span class="nx">maxWidth</span> <span class="o">=</span> <span class="mi">400</span><span class="p">;</span>
</pre></div>
<h3 id="bitmaptext-purge-glyphs">Bitmaptext Purge Glyphs</h3>
<p>Bitmap文本清除字符精灵</p>
<div class="highlight"><pre><span></span><span class="c1">//长文本变短时，应清空BitmapText._glyphs数组中滞留的字符精灵</span>
<span class="kd">var</span> <span class="nx">purged</span> <span class="o">=</span> <span class="nx">bmpText</span><span class="p">.</span><span class="nx">purgeGlyphs</span><span class="p">();</span>
</pre></div>
<h3 id="bitmaptext-with-physics">Bitmaptext With Physics</h3>
<p>有物理属性的Bitmap文本</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">startSystem</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="nx">text1</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'desyrel'</span><span class="p">,</span> <span class="s1">'BitmapText'</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
<span class="nx">text2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">'stack'</span><span class="p">,</span> <span class="s1">'with Physics'</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">enable</span><span class="p">([</span> <span class="nx">text1</span><span class="p">,</span> <span class="nx">text2</span> <span class="p">]);</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">velocity</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">text1</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
<h3 id="retro-font-1">Retro Font 1</h3>
<p>retroFont复古字体</p>
<div class="highlight"><pre><span></span><span class="c1">//retroFont复古字体只生成一个对象，而Bitmap文本为每个字母生成一个对象</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'knightHawks'</span><span class="p">,</span> <span class="s1">'assets/fonts/retroFonts/KNIGHT3.png'</span><span class="p">);</span>
<span class="nx">font</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">retroFont</span><span class="p">(</span><span class="s1">'knightHawks'</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">RetroFont</span><span class="p">.</span><span class="nx">TEXT_SET6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nx">font</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="s2">"phaser x: "</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s2">" y: "</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
</pre></div>
<h2 id="debug">DEBUG：调试信息</h2>
<p>通过叠加场景render渲染调试信息</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 画出调试工具</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span> <span class="nx">rect</span><span class="p">,</span> <span class="s1">'rgba(255,0,0,1)'</span> <span class="p">)</span> <span class="p">;</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span> <span class="nx">circle</span><span class="p">,</span> <span class="s1">'rgba(255,255,0,1)'</span> <span class="p">)</span> <span class="p">;</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span> <span class="nx">point</span><span class="p">,</span> <span class="s1">'rgba(255,255,255,1)'</span> <span class="p">)</span> <span class="p">;</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">pixel</span><span class="p">(</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="s1">'rgba(0,255,255,1)'</span> <span class="p">)</span> <span class="p">;</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span> <span class="s2">"This is debug text"</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">380</span> <span class="p">);</span>

    <span class="c1">// Camera调试信息</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">cameraInfo</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>

    <span class="c1">// Display调试信息</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">spriteBounds</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">spriteCorners</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="c1">// Input输入调试信息</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">inputInfo</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">spriteInputInfo</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">130</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">pointer</span><span class="p">(</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span> <span class="p">);</span>

    <span class="c1">// Physics调试信息</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">body</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>

    <span class="c1">// Sprite调试信息</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">spriteInfo</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h2 id="tile-sprites">TILE SPRITES：瓷砖精灵</h2>
<h3 id="tiling-sprite">Tiling Sprite</h3>
<p>生成铺砖精灵</p>
<div class="highlight"><pre><span></span><span class="c1">// (x, y, width, height, key)</span>
<span class="nx">tileSprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tileSprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="s1">'starfield'</span><span class="p">);</span>
</pre></div>
<h3 id="animated-tiling-sprite">Animated Tiling Sprite</h3>
<p>移动瓷砖铺设的精灵tileSprite</p>
<div class="highlight"><pre><span></span><span class="nx">tilesprite</span><span class="p">.</span><span class="nx">tileScale</span><span class="p">.</span><span class="nx">x</span><span class="o">++</span>
<span class="nx">tilesprite</span><span class="p">.</span><span class="nx">tilePosition</span><span class="p">.</span><span class="nx">y</span><span class="o">++</span>
<span class="nx">tilesprite</span><span class="p">.</span><span class="nx">x</span><span class="o">++</span>
</pre></div>
<h3 id="sprite-sheet-tiling-sprite">Sprite Sheet Tiling Sprite</h3>
<p>用精灵条spritesheet铺设的铺砖精灵tileSprite</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'mummy'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tileSprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="s1">'mummy'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="tiling-sprite-atlas">Tiling Sprite Atlas</h3>
<p>用图集Atlas生成铺砖精灵tileSprite</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures_json.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures_json.json'</span><span class="p">);</span>
<span class="c1">//  'seacreatures'是缓存中的图集</span>
<span class="c1">//  'octopus0002'是图集中的帧</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tileSprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'octopus0002'</span><span class="p">);</span>
</pre></div>
<h3 id="colliding-with-tiling-sprite">Colliding With Tiling Sprite</h3>
<p>铺砖精灵tileSprite的碰撞</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'starfield'</span><span class="p">,</span> <span class="s1">'assets/misc/starfield.jpg'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'ball'</span><span class="p">,</span> <span class="s1">'assets/sprites/pangball.png'</span><span class="p">);</span>
<span class="nx">ball</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'ball'</span><span class="p">);</span>
<span class="nx">tilesprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tileSprite</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'starfield'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">enable</span><span class="p">([</span> <span class="nx">ball</span><span class="p">,</span> <span class="nx">tilesprite</span> <span class="p">],</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Physics</span><span class="p">.</span><span class="nx">ARCADE</span><span class="p">);</span>
<span class="nx">ball</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">ball</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">bounce</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nx">tilesprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">collideWorldBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">tilesprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">immovable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">tilesprite</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">allowGravity</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">ball</span><span class="p">,</span> <span class="nx">tilesprite</span><span class="p">);</span>
</pre></div>
<h3 id="tile-sprite-from-animated-sprite">Tile Sprite From Animated Sprite</h3>
<p>铺砖精灵动画</p>
<div class="highlight"><pre><span></span><span class="nx">water</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tileSprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">'waters'</span><span class="p">);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves0'</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves1'</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves2'</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves3'</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves4'</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves5'</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves6'</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">25</span><span class="p">]);</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'waves7'</span><span class="p">,</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">29</span><span class="p">]);</span>
<span class="c1">// change to animation num</span>
<span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
<span class="nx">water</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'waves'</span> <span class="o">+</span> <span class="nx">n</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h2 id="tilemaps">TILEMAPS：瓷砖地图</h2>
<h3 id="blank-tilemap">Blank Tilemap</h3>
<p>生成空白铺砖地图</p>
<div class="highlight"><pre><span></span><span class="nx">map</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tilemap</span><span class="p">();</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addTilesetImage</span><span class="p">(</span><span class="s1">'ground_1x1'</span><span class="p">);</span>
<span class="c1">//  40x30块，每块32x32像素</span>
<span class="nx">layer1</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'level1'</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="nx">layer1</span><span class="p">.</span><span class="nx">scrollFactorX</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="nx">layer1</span><span class="p">.</span><span class="nx">scrollFactorY</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="c1">// 卷动世界</span>
<span class="nx">layer1</span><span class="p">.</span><span class="nx">resizeWorld</span><span class="p">();</span>
<span class="nx">layer2</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">createBlankLayer</span><span class="p">(</span><span class="s1">'level2'</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</pre></div>
<h3 id="create-from-array">Create From Array</h3>
<p>通过数组生成铺砖地图</p>
<div class="highlight"><pre><span></span><span class="c1">//  把位置数组加入缓存中</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">addTilemap</span><span class="p">(</span><span class="s1">'dynamicMap'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Tilemap</span><span class="p">.</span><span class="nx">CSV</span><span class="p">);</span>
<span class="nx">map</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tilemap</span><span class="p">(</span><span class="s1">'dynamicMap'</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addTilesetImage</span><span class="p">(</span><span class="s1">'tiles'</span><span class="p">,</span> <span class="s1">'tiles'</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="nx">layer</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">createLayer</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="create-from-objects">Create From Objects</h3>
<p>从对象生成地图（没看懂）</p>
<h3 id="csv-map">Csv Map</h3>
<p>Csv地图</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">tilemap</span><span class="p">(</span><span class="s1">'map'</span><span class="p">,</span> <span class="s1">'assets/tilemaps/csv/catastrophi_level2.csv'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Tilemap</span><span class="p">.</span><span class="nx">CSV</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'tiles'</span><span class="p">,</span> <span class="s1">'assets/tilemaps/tiles/catastrophi_tiles_16.png'</span><span class="p">);</span>
<span class="nx">map</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tilemap</span><span class="p">(</span><span class="s1">'map'</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addTilesetImage</span><span class="p">(</span><span class="s1">'tiles'</span><span class="p">);</span>
<span class="nx">layer</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">createLayer</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nx">layer</span><span class="p">.</span><span class="nx">resizeWorld</span><span class="p">();</span>
</pre></div>
<h3 id="csv-map-collide">Csv Map Collide</h3>
<p>与Csv地图碰撞</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span> <span class="nx">layer</span><span class="p">);</span>
</pre></div>
<h3 id="csv-map-with-p2">CSV MAP WITH P2</h3>
<p>（存目）</p>
<h3 id="features-test">Features Test</h3>
<p>状态监测</p>
<div class="highlight"><pre><span></span><span class="nx">map</span><span class="p">.</span><span class="nx">setCollisionBetween</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">);</span>
<span class="c1">//  This will set Tile ID 26 (the coin) to call the hitCoin function when collided with</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">setTileIndexCallback</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="nx">hitCoin</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//  This will set the map location 2, 0 to call the function</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">setTileLocationCallback</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">hitCoin</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="fill-tiles">Fill Tiles</h3>
<p>瓷砖填充</p>
<div class="highlight"><pre><span></span><span class="nx">map</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getTileX</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getTileY</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
</pre></div>
<h3 id="paint-tiles">Paint Tiles</h3>
<p>绘制（拾取、替换）瓷砖</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">map</span><span class="p">.</span><span class="nx">getTile</span><span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">getTileX</span><span class="p">(</span><span class="nx">marker</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getTileY</span><span class="p">(</span><span class="nx">marker</span><span class="p">.</span><span class="nx">y</span><span class="p">)).</span><span class="nx">index</span> <span class="o">!=</span> <span class="nx">currentTile</span><span class="p">.</span><span class="nx">index</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">putTile</span><span class="p">(</span><span class="nx">currentTile</span><span class="p">,</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getTileX</span><span class="p">(</span><span class="nx">marker</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getTileY</span><span class="p">(</span><span class="nx">marker</span><span class="p">.</span><span class="nx">y</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
<h3 id="randomise-tiles">Randomise Tiles</h3>
<p>随机瓷砖</p>
<div class="highlight"><pre><span></span><span class="nx">map</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">layer</span><span class="p">.</span><span class="nx">getTileX</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">getTileY</span><span class="p">(</span><span class="nx">sprite</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</pre></div>
<h3 id="replace-tiles">Replace Tiles</h3>
<p>替换瓷砖</p>
<div class="highlight"><pre><span></span><span class="c1">//  整层替换某类瓷砖，可指定范围 x, y, width, height</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">46</span><span class="p">);</span>
</pre></div>
<h3 id="swap-tiles">Swap Tiles</h3>
<p>倒换瓷砖</p>
<div class="highlight"><pre><span></span><span class="c1">//  整层倒换两类瓷砖，可限制范围x, y, width, height</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">swap</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">);</span>
</pre></div>
<h3 id="resize-map">Resize Map</h3>
<p>调整地图尺寸</p>
<div class="highlight"><pre><span></span><span class="nx">layer</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="nx">layer</span><span class="p">.</span><span class="nx">resizeWorld</span><span class="p">();</span>
<span class="nx">layer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>
</pre></div>
<h3 id="tile-callbacks">Tile Callbacks</h3>
<p>瓷砖调用</p>
<div class="highlight"><pre><span></span><span class="c1">//  设置瓷砖碰撞时26 (the coin)调用hitCoin</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">setTileIndexCallback</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="nx">hitCoin</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//  设置瓷砖（2, 0）调用</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">setTileLocationCallback</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">hitCoin</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="tileset-from-bitmapdata">Tileset From Bitmapdata</h3>
<p>通过Bitmapdata生成map</p>
<div class="highlight"><pre><span></span><span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addTilesetImage</span><span class="p">(</span><span class="s1">'tiles'</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">);</span>
</pre></div>
<h2 id="camera">CAMERA：镜头</h2>
<h3 id="moving-the-camera">Moving The Camera</h3>
<p>移动镜头</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="mi">4</span><span class="p">;</span>
</pre></div>
<h3 id="basic-follow">Basic Follow</h3>
<p>镜头跟随</p>
<div class="highlight"><pre><span></span><span class="c1">//Camera.follow(target, style, lerpX, lerpY): void;</span>
<span class="c1">//线性插值lerpX、lerpY，值越小镜头越平稳，跟进也越慢</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">follow</span><span class="p">(</span><span class="nx">player</span><span class="p">);</span>
</pre></div>
<h3 id="camera-fade">Camera Fade</h3>
<p>淡出</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">follow</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Camera</span><span class="p">.</span><span class="nx">FOLLOW_LOCKON</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">onDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">fade</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">onFadeComplete</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">resetFade</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">onDown</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">fade</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">fade</span><span class="p">()</span> <span class="p">{</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">fade</span><span class="p">(</span><span class="mh">0x000000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">);</span>
<span class="p">}</span>
    <span class="kd">function</span> <span class="nx">resetFade</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">resetFX</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<h3 id="camera-flash">Camera Flash</h3>
<p>镜头闪动</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">flash</span><span class="p">(</span><span class="mh">0xff0000</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</pre></div>
<h3 id="camera-shake">Camera Shake</h3>
<p>镜头晃动</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">shake</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</pre></div>
<h3 id="deadzone">Deadzone</h3>
<p>定死区域</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">follow</span><span class="p">(</span><span class="nx">player</span><span class="p">);</span>
<span class="c1">//  如果目标在限定区域则不摇动镜头，要突出边界时才摇动</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">deadzone</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
</pre></div>
<h3 id="fixed-to-camera">Fixed To Camera</h3>
<p>与镜头绑定</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">'phaser'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">fixedToCamera</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">cameraOffset</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</pre></div>
<h3 id="follow-styles">Follow Styles</h3>
<p>镜头跟随类型</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">follow</span><span class="p">(</span><span class="nx">ufo</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Camera</span><span class="p">.</span><span class="nx">FOLLOW_LOCKON</span><span class="p">);</span>
<span class="nx">style</span> <span class="o">=</span> <span class="s1">'STYLE_LOCKON'</span><span class="p">;</span>
<span class="c1">//style = 'STYLE_PLATFORMER';</span>
<span class="c1">//style = 'STYLE_TOPDOWN';</span>
<span class="c1">//style = 'STYLE_TOPDOWN_TIGHT';</span>
</pre></div>
<h2 id="world">WORLD：世界</h2>
<h3 id="fixed-to-camera_1">Fixed To Camera</h3>
<p>固定sprite、text到镜头/前</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'phaser'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">fixedToCamera</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">cameraOffset</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"this text is fixed to the camera"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"32px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#ffffff"</span><span class="p">,</span> <span class="nx">align</span><span class="o">:</span> <span class="s2">"center"</span> <span class="p">});</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">fixedToCamera</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">text</span><span class="p">.</span><span class="nx">cameraOffset</span><span class="p">.</span><span class="nx">setTo</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="c1">//镜头跟随见实例### World Wrap</span>
<span class="c1">//game.camera.follow(sprite);</span>
</pre></div>
<h3 id="move-around-world">Move Around World</h3>
<p>镜头移动</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</pre></div>
<h3 id="world-wrap">World Wrap</h3>
<p>世界折返</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">card</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h2 id="display">DISPLAY：显示</h2>
<h3 id="circle">Circle</h3>
<p>画圆</p>
<div class="highlight"><pre><span></span><span class="nx">graphics</span><span class="p">.</span><span class="nx">drawCircle</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
</pre></div>
<h3 id="ellips">Ellips</h3>
<p>画椭圆</p>
<div class="highlight"><pre><span></span><span class="nx">graphics</span><span class="p">.</span><span class="nx">drawEllipse</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</pre></div>
<h3 id="arc">Arc</h3>
<p>画扇形/弧线</p>
<div class="highlight"><pre><span></span><span class="nx">graphics</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">math</span><span class="p">.</span><span class="nx">degToRad</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="nx">game</span><span class="p">.</span><span class="nx">math</span><span class="p">.</span><span class="nx">degToRad</span><span class="p">(</span><span class="mi">180</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span>
</pre></div>
<h3 id="arcade-physics-graphics-shape">Arcade Physics Graphics Shape</h3>
<p>给Graphics图形赋予物理属性</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">graphics</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">graphics</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">physics</span><span class="p">.</span><span class="nx">arcade</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">graphics</span><span class="p">);</span>
</pre></div>
<h3 id="extract-mask">Extract Mask</h3>
<p>同色提取到遮罩</p>
<div class="highlight"><pre><span></span><span class="nx">bitmapData</span><span class="p">.</span><span class="nx">extract</span><span class="p">(</span><span class="nx">bitmapData_mask</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">140</span><span class="p">);</span>
</pre></div>
<h3 id="fullscreen">Fullscreen</h3>
<p>全屏</p>
<div class="highlight"><pre><span></span><span class="c1">// 拉伸以填满</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">fullScreenScaleMode</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">ScaleManager</span><span class="p">.</span><span class="nx">EXACT_FIT</span><span class="p">;</span>
<span class="c1">// 保持原尺寸</span>
<span class="c1">// game.scale.fullScreenScaleMode = Phaser.ScaleManager.NO_SCALE;</span>
<span class="c1">// 保持比例</span>
<span class="c1">// game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">startFullScreen</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="c1">//game.scale.stopFullScreen();</span>
</pre></div>
<h3 id="game-background-color">Game Background Color</h3>
<p>游戏背景色</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"#4488AA"</span><span class="p">;</span>
<span class="c1">// game.stage.backgroundColor = 0x4488aa;</span>
<span class="c1">// game.stage.backgroundColor = 'rgb(68, 136, 170)';</span>
<span class="c1">// game.stage.backgroundColor = 'rgba(68, 136, 170, 0.5)';</span>
<span class="c1">//随机色</span>
<span class="c1">// game.stage.backgroundColor = Phaser.Color.getRandomColor(50, 255, 255);</span>
</pre></div>
<h3 id="generate-texture-from-graphics">Generate Texture From Graphics</h3>
<p>用图形生成材质</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="nx">graphics</span><span class="p">.</span><span class="nx">generateTexture</span><span class="p">());</span>
</pre></div>
<h3 id="gradient">Gradient</h3>
<p>在遍历中步进插色以生成渐变</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Color</span><span class="p">.</span><span class="nx">interpolateColor</span><span class="p">(</span><span class="mh">0x66d973</span><span class="p">,</span> <span class="mh">0x40b54d</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
    <span class="c1">//Phaser.Color.interpolateColorWithRGB(color, r, g, b, steps, currentStep) : number;</span>
    <span class="nx">bmd</span><span class="p">.</span><span class="nx">rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="nx">y</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Color</span><span class="p">.</span><span class="nx">getWebRGB</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Color</span><span class="p">.</span><span class="nx">getWebRGB</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span>
    <span class="nx">y</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="graphics">Graphics</h3>
<p>绘制图形</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">graphics</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">graphics</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="c1">// 设置填充和线条样式</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0xFF3300</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">lineStyle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mh">0xffd900</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// 用直线逐步绘制图形</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">220</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">220</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">endFill</span><span class="p">();</span>
<span class="c1">// 绘制二次方程曲线</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">quadraticCurveTo</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="c1">// 绘制方形</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="c1">// 绘制圆形</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">drawCircle</span><span class="p">(</span><span class="mi">470</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
</pre></div>
<h3 id="graphics-input-events">Graphics Input Events</h3>
<p>图形输入事件</p>
<div class="highlight"><pre><span></span><span class="nx">graphics</span><span class="p">.</span><span class="nx">inputEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">useHandCursor</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//graphics.events.onInputDown.add(onDown, this);</span>
<span class="c1">//graphics.events.onInputUp.add(onUp, this);</span>
<span class="c1">//graphics.events.onInputOut.add(onOut, this);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">onInputOver</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onOver</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">onOver</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
<h3 id="hsv-color-wheel">Hsv Color Wheel</h3>
<p>Hsv色盘</p>
<div class="highlight"><pre><span></span><span class="nx">colorsArray</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Color</span><span class="p">.</span><span class="nx">HSVColorWheel</span><span class="p">();</span>
</pre></div>
<h3 id="pixi-render-texture">Pixi Render Texture</h3>
<p>生成Pixi渲染材质</p>
<div class="highlight"><pre><span></span><span class="nx">renderTexture</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">renderTexture</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="s1">'texture1'</span><span class="p">);</span>
</pre></div>
<h3 id="render-texture-image">Render Texture Image</h3>
<p>生成渲染材质图像</p>
<div class="highlight"><pre><span></span><span class="nx">ball</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'ball'</span><span class="p">);</span>
<span class="nx">texture</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">renderTexture</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">texture</span><span class="p">);</span>
<span class="c1">//将sprite加入材质中</span>
<span class="nx">texture</span><span class="p">.</span><span class="nx">renderXY</span><span class="p">(</span><span class="nx">ball</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="render-crisp">Render Crisp</h3>
<p>渲染锐化？</p>
<div class="highlight"><pre><span></span><span class="nx">sprite</span><span class="p">.</span><span class="nx">smoothed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="c1">//  全舞台锐化</span>
<span class="c1">// game.stage.smoothed = false;</span>
</pre></div>
<h3 id="sprite-shadow">Sprite Shadow</h3>
<p>用tint着色法生成阴影</p>
<div class="highlight"><pre><span></span><span class="nx">shadow</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="s1">'hotdog'</span><span class="p">);</span>
<span class="nx">shadow</span><span class="p">.</span><span class="nx">tint</span> <span class="o">=</span> <span class="mh">0x000000</span><span class="p">;</span>
<span class="nx">shadow</span><span class="p">.</span><span class="nx">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">;</span>
</pre></div>
<h3 id="viewport">Viewport</h3>
<p>视图/窗口尺寸</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">viewportWidth</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">viewportHeight</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">outerWidth</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">outerHeight</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">documentWidth</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">documentHeight</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">availWidth</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">availHeight</span>
</pre></div>
<h2 id="bitmapdatabitmapd">BITMAPDATA：BITMAPD数据</h2>
<h3 id="fastcopy-draw">Fastcopy Draw</h3>
<p>快速拷贝</p>
<div class="highlight"><pre><span></span><span class="nx">bmdDest</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">bmd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="copy-bitmapdata">Copy Bitmapdata</h3>
<p>拷贝Bitmapdata</p>
<div class="highlight"><pre><span></span><span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">);</span>
<span class="c1">//贴图</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="s1">'pic'</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">();</span>
<span class="nx">bmd2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
<span class="nx">bmd2</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">'rgba(255,0,255,0.2)'</span><span class="p">);</span>
<span class="c1">//画出Bitmapdata数据</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">bmd2</span><span class="p">,</span> <span class="nx">x</span> <span class="o">-</span> <span class="mi">16</span><span class="p">,</span> <span class="nx">y</span> <span class="o">-</span> <span class="mi">16</span><span class="p">);</span>
</pre></div>
<h3 id="copy-pixels">Copy Pixels</h3>
<p>拷贝像素</p>
<div class="highlight"><pre><span></span><span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">();</span>
<span class="nx">area</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="c1">//拷贝图片的矩形区域</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">copyRect</span><span class="p">(</span><span class="s1">'pic'</span><span class="p">,</span> <span class="nx">area</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="draw-sprite">Draw Sprite</h3>
<p>绘制精灵</p>
<div class="highlight"><pre><span></span><span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">();</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>
<h3 id="alpha-mask">Alpha Mask</h3>
<p>alphaMask透明度遮罩</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">256</span><span class="p">);</span>
<span class="c1">// 原图pic应用遮罩mask后拷贝到bmd中</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">alphaMask</span><span class="p">(</span><span class="s1">'pic'</span><span class="p">,</span> <span class="s1">'mask'</span><span class="p">);</span>
<span class="c1">// BitmapData只是材质，转换为sprite或image后显示</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">).</span><span class="nx">anchor</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
<h3 id="atlas">Atlas</h3>
<p>图集</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures_json.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures_json.json'</span><span class="p">);</span>
<span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">);</span>
<span class="c1">//选择seacreatures图集中的blueJellyfish0010帧生成sprite</span>
<span class="nx">jellyfish</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'blueJellyfish0010'</span><span class="p">);</span>
<span class="c1">//(prefix, start, stop, suffix, zeroPad) 指文件名（如explosion_0001-large）的前部字符串（explosion_）、开始编号（1）、结束编号、后缀字符串（-large）、编号的填零位数（4）</span>
<span class="nx">jellyfish</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'swim'</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Animation</span><span class="p">.</span><span class="nx">generateFrameNames</span><span class="p">(</span><span class="s1">'blueJellyfish'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">jellyfish</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'swim'</span><span class="p">);</span>
<span class="c1">//  画上的是动画当前帧</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">jellyfish</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
</pre></div>
<h3 id="cached-bitmapdata">Cached Bitmapdata</h3>
<p>缓存Bitmapdata数据</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="c1">//填充渐变</span>
<span class="kd">var</span> <span class="nx">grd</span> <span class="o">=</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">createLinearGradient</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="nx">grd</span><span class="p">.</span><span class="nx">addColorStop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'#8ED6FF'</span><span class="p">);</span>
<span class="nx">grd</span><span class="p">.</span><span class="nx">addColorStop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'#004CB3'</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">grd</span><span class="p">;</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="c1">//重新渲染</span>
<span class="c1">//bmd.dirty = true;</span>
<span class="c1">//  缓存与取用</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">addBitmapData</span><span class="p">(</span><span class="s1">'blueShade'</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getBitmapData</span><span class="p">(</span><span class="s1">'blueShade'</span><span class="p">));</span>
</pre></div>
<h3 id="draw-atlas-frame">Draw Atlas Frame</h3>
<p>绘制图集的帧</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'atlas'</span><span class="p">,</span> <span class="s1">'assets/sprites/atlas_hash_trim.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/atlas_json_hash_trim.json'</span><span class="p">);</span>
<span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">'atlas'</span><span class="p">,</span> <span class="s1">'contra3'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">tint</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">sprite</span><span class="p">);</span>
</pre></div>
<h3 id="draw-full">Draw Full</h3>
<p>全部绘制</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bmdContainer</span> <span class="o">=</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">(</span><span class="mi">390</span><span class="p">,</span> <span class="mi">290</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">updateTransform</span><span class="p">();</span>
<span class="c1">//  把world整个儿绘制到BitmapData</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">drawFull</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">);</span>
</pre></div>
<h3 id="draw-group">Draw Group</h3>
<p>绘制组</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bmd</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapData</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bmdContainer</span> <span class="o">=</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">(</span><span class="mi">390</span><span class="p">,</span> <span class="mi">290</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">updateTransform</span><span class="p">();</span>
<span class="c1">// bmd.drawGroup(group);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">drawGroup</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">);</span>
</pre></div>
<h3 id="get-pixel">Get Pixel</h3>
<p>取得像素</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">getPixelRGB</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">rect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="nx">color</span><span class="p">.</span><span class="nx">rgba</span><span class="p">);</span>
</pre></div>
<h3 id="process-pixels-1">Process Pixels 1</h3>
<p>处理像素</p>
<div class="highlight"><pre><span></span><span class="c1">//processPixelRGB(callback, callbackContext, x, y, width, height) </span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">processPixelRGB</span><span class="p">(</span><span class="nx">forEachPixel</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">forEachPixel</span> <span class="p">(</span><span class="nx">pixel</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//换色</span>
    <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">pixel</span><span class="p">.</span><span class="nx">r</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="nx">pixel</span><span class="p">.</span><span class="nx">g</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">pixel</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
    <span class="nx">pixel</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
    <span class="nx">pixel</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">g</span><span class="p">;</span>
    <span class="nx">pixel</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
    <span class="c1">//灰度效果，见### Process Pixels 2</span>
    <span class="c1">//pixel.r = pixel.r;</span>
    <span class="c1">//pixel.g = pixel.r;</span>
    <span class="c1">//pixel.b = pixel.r;</span>
    <span class="c1">//反色</span>
    <span class="c1">//pixel.r = 255 - pixel.r;</span>
    <span class="c1">//pixel.g = 255 - pixel.g;</span>
    <span class="c1">//pixel.b = 255 - pixel.b;</span>
    <span class="k">return</span> <span class="nx">pixel</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="radial-gradient">Radial Gradient</h3>
<p>放射状渐变</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">grd</span> <span class="o">=</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">createRadialGradient</span><span class="p">(</span><span class="nx">innerCircle</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">innerCircle</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">innerCircle</span><span class="p">.</span><span class="nx">radius</span><span class="p">,</span> <span class="nx">outerCircle</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">outerCircle</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">outerCircle</span><span class="p">.</span><span class="nx">radius</span><span class="p">);</span>
</pre></div>
<h3 id="replace-color">Replace Color</h3>
<p>替换颜色</p>
<div class="highlight"><pre><span></span><span class="c1">// replaceRGB: function (sourceR, sourceG, sourceB, sourceA, destR, destG, destB, destA, region) </span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">replaceRGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">255</span><span class="p">);</span>
</pre></div>
<h3 id="set-hsl">Set Hsl</h3>
<p>设置、调整HSL色彩空间</p>
<div class="highlight"><pre><span></span><span class="c1">//BitmapData.setHSL(h, s, l, region)</span>
<span class="c1">// bmd.setHSL(0.2);</span>
<span class="c1">//BitmapData.shiftHSL(h, s, l, region) 在原值上累积</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">shiftHSL</span><span class="p">(</span><span class="mf">0.1</span><span class="p">);</span>
<span class="c1">// bmd.shiftHSL(0.1, null, null, new Phaser.Rectangle(32, 32, 100, 100));</span>
<span class="c1">//亮度调到最高/白色</span>
<span class="c1">// bmd.shiftHSL(null, null, 1.0);</span>
<span class="c1">//降低饱和度</span>
<span class="c1">// bmd.shiftHSL(null, -1.0, null);</span>
</pre></div>
<h3 id="sprite-texture">Sprite Texture</h3>
<p>用作精灵材质</p>
<div class="highlight"><pre><span></span><span class="c1">//  绘制图形</span>
<span class="c1">//清除</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">cls</span><span class="p">();</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">'rgba(255,0,0,0.8)'</span><span class="p">);</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">rect</span><span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="s1">'rgba(255,0,255,0.8)'</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="nx">bmd</span><span class="p">);</span>
</pre></div>
<h3 id="text_1">Text</h3>
<p>绘制文本</p>
<div class="highlight"><pre><span></span><span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">make</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"phaser"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"bold 32px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#ff0044"</span> <span class="p">});</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomY</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">'destination-out'</span><span class="p">);</span>
</pre></div>
<h2 id="geometry">GEOMETRY：几何形状</h2>
<h3 id="line">Line</h3>
<div class="highlight"><pre><span></span><span class="nx">line1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="nx">handle1</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">handle1</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">handle2</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">handle2</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="c1">//在update中：</span>
<span class="c1">//从sprite获得新的端点位置，根据sprite划线</span>
<span class="nx">line1</span><span class="p">.</span><span class="nx">fromSprite</span><span class="p">(</span><span class="nx">sprite1</span><span class="p">,</span> <span class="nx">sprite2</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</pre></div>
<h3 id="rotate-line">Rotate Line</h3>
<p>旋转</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">line</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="line-bounds">Line Bounds</h3>
<p>调试</p>
<div class="highlight"><pre><span></span><span class="nx">line</span><span class="p">.</span><span class="nx">end</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="nx">line</span><span class="p">.</span><span class="nx">start</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">pointer</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">pointer</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">rectangle</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
</pre></div>
<h3 id="center-line">Center Line</h3>
<p>通过中点点位线</p>
<div class="highlight"><pre><span></span><span class="nx">line</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="nx">line</span><span class="p">.</span><span class="nx">centerOn</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">activePointer</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="nx">line</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="mf">0.05</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
</pre></div>
<h3 id="centroid">Centroid</h3>
<p>中心（重心）</p>
<div class="highlight"><pre><span></span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">.</span><span class="nx">centroid</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span> <span class="nx">out</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">;</span>
<span class="nx">points</span><span class="err">：</span><span class="nb">Array</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="o">&gt;</span>
<span class="nx">out</span> <span class="p">(</span><span class="nx">optional</span><span class="p">)</span><span class="err">：</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span> <span class="c1">//存储结果的点，如果不设置则返回一个结果点</span>
<span class="nx">returns</span><span class="err">：</span><span class="nx">Point</span>

<span class="kd">var</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">centroid</span><span class="p">;</span>
<span class="nx">points</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">img</span><span class="p">.</span><span class="nx">position</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">.</span><span class="nx">centroid</span><span class="p">(</span><span class="nx">points</span><span class="p">);</span>
<span class="nx">centroid</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">copyFrom</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>
</pre></div>
<h3 id="circle_1">Circle</h3>
<p>圆形</p>
<div class="highlight"><pre><span></span><span class="nx">circle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Circle</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">64</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span><span class="nx">circle</span><span class="p">,</span><span class="s1">'#cfffff'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Diameter : '</span><span class="o">+</span><span class="nx">circle</span><span class="p">.</span><span class="nx">diameter</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Circumference : '</span><span class="o">+</span><span class="nx">circle</span><span class="p">.</span><span class="nx">circumference</span><span class="p">(),</span><span class="mi">50</span><span class="p">,</span><span class="mi">230</span><span class="p">);</span>
</pre></div>
<h3 id="circle-random-point">Circle Random Point</h3>
<p>圆中的随机点</p>
<div class="highlight"><pre><span></span><span class="nx">circle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Circle</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">();</span>
<span class="nx">circle</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
<span class="c1">//  ellipse.random(p);  //椭圆中的随机点</span>
<span class="c1">//  line.random(p); //线中随机点</span>
<span class="c1">//  rectangle.random(p); //方形中随机点</span>
<span class="c1">//  将浮点数转为整书</span>
<span class="nx">p</span><span class="p">.</span><span class="nx">floor</span><span class="p">();</span>
<span class="nx">bmd</span><span class="p">.</span><span class="nx">setPixel</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">r</span><span class="p">,</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">g</span><span class="p">,</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">b</span><span class="p">);</span>
</pre></div>
<h3 id="line-intersection">Line Intersection</h3>
<p>两线交点</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">();</span>
<span class="nx">p</span> <span class="o">=</span> <span class="nx">line1</span><span class="p">.</span><span class="nx">intersects</span><span class="p">(</span><span class="nx">line2</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="line-midpoint">Line Midpoint</h3>
<p>线段中点</p>
<div class="highlight"><pre><span></span><span class="nx">mid</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">();</span>
<span class="nx">line</span><span class="p">.</span><span class="nx">midPoint</span><span class="p">(</span><span class="nx">mid</span><span class="p">);</span>
</pre></div>
<h3 id="line-reflection">Line Reflection</h3>
<p>线的镜像</p>
<div class="highlight"><pre><span></span><span class="c1">//  Update the normal from the intersection point (100px length)</span>
<span class="nx">line3</span><span class="p">.</span><span class="nx">fromAngle</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">line2</span><span class="p">.</span><span class="nx">normalAngle</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="c1">//  Either of these is fine:</span>
<span class="c1">// var outgoing = Phaser.Line.reflect(line1, line2);</span>
<span class="kd">var</span> <span class="nx">outgoing</span> <span class="o">=</span> <span class="nx">line1</span><span class="p">.</span><span class="nx">reflect</span><span class="p">(</span><span class="nx">line2</span><span class="p">);</span>
<span class="nx">reflection</span><span class="p">.</span><span class="nx">fromAngle</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">outgoing</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
</pre></div>
<h3 id="playing-with-points">Playing With Points</h3>
<p>点运动</p>
<div class="highlight"><pre><span></span><span class="nx">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">);</span>
<span class="nx">p2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">p1</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">p3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">p2</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">p2</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">p4</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">p3</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">p3</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="mi">50</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//绕点旋转</span>
    <span class="c1">//Phaser.Point.rotate(x, y, angle, asDegrees, distance)</span>
    <span class="nx">p2</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p1</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">d2</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">150</span><span class="p">);</span>
    <span class="nx">p3</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="nx">p2</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p2</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">d3</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
    <span class="nx">p4</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="nx">p3</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p3</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">d4</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//在CANVAS渲染材质上绘图</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="s1">'rgb(0,255,255)'</span><span class="p">;</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p1</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">p2</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p2</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">p3</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p3</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">p4</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p4</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">closePath</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<h3 id="polygon">Polygon</h3>
<p>绘制多边形</p>
<div class="highlight"><pre><span></span><span class="c1">//  用Point数组绘制</span>
<span class="c1">// poly = new Phaser.Polygon([ new Phaser.Point(200, 100), new Phaser.Point(350, 100), new Phaser.Point(375, 200), new Phaser.Point(150, 200) ]);</span>
<span class="c1">//  用Point参数绘制</span>
<span class="c1">// poly = new Phaser.Polygon(new Phaser.Point(200, 100), new Phaser.Point(350, 100), new Phaser.Point(375, 200), new Phaser.Point(150, 200));</span>
<span class="c1">//  用x,y数值数组绘制</span>
<span class="c1">// poly = new Phaser.Polygon([200, 100, 350, 100, 375, 200, 150, 200]);</span>
<span class="c1">//  用x,y参数绘制</span>
<span class="c1">// poly = new Phaser.Polygon(200, 100, 350, 100, 375, 200, 150, 200);</span>
<span class="c1">//  用混合类型数组绘制</span>
<span class="c1">// poly = new Phaser.Polygon([ new Phaser.Point(200, 100), 350, 100, 375, 200, new Phaser.Point(150, 200) ]);</span>
<span class="c1">//  用混合类型参数绘制</span>
<span class="c1">// poly = new Phaser.Polygon(new Phaser.Point(200, 100), 350, 100, 375, 200, new Phaser.Point(150, 200));</span>
<span class="c1">//  用包含x,y属性的对象数组绘制</span>
<span class="c1">// poly = new Phaser.Polygon([ { x: 200, y: 100 }, { x: 350, y: 100 }, { x: 375, y: 200}, { x: 150, y: 200 } ]);</span>
<span class="c1">//  用包含x,y属性的对象作为参数绘制</span>
<span class="c1">// poly = new Phaser.Polygon( { x: 200, y: 100 }, { x: 350, y: 100 }, { x: 375, y: 200}, { x: 150, y: 200 });</span>
<span class="c1">//  先生成空多边形</span>
<span class="nx">poly</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">();</span>
<span class="c1">//  再用setTo绘制，参数同上各式</span>
<span class="nx">poly</span><span class="p">.</span><span class="nx">setTo</span><span class="p">([</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mi">350</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mi">375</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="p">]);</span>
<span class="nx">graphics</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">graphics</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">beginFill</span><span class="p">(</span><span class="mh">0xFF33ff</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">drawPolygon</span><span class="p">(</span><span class="nx">poly</span><span class="p">.</span><span class="nx">points</span><span class="p">);</span>
<span class="nx">graphics</span><span class="p">.</span><span class="nx">endFill</span><span class="p">();</span>
</pre></div>
<h3 id="polygon-contains">Polygon Contains</h3>
<p>多边形包含判断</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">poly</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">y</span><span class="p">)){}</span>
</pre></div>
<h3 id="rectangle">Rectangle</h3>
<p>方形</p>
<div class="highlight"><pre><span></span><span class="nx">floor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">render</span> <span class="p">()</span> <span class="p">{</span><span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span><span class="nx">floor</span><span class="p">,</span><span class="s1">'#0fffff'</span><span class="p">);}</span>
</pre></div>
<h3 id="rectangle-get-point">Rectangle Get Point</h3>
<p>方形取定位点</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Point</span><span class="p">();</span>
<span class="nx">rectangle</span><span class="p">.</span><span class="nx">getPoint</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">TOP_LEFT</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
</pre></div>
<h3 id="rectangle-intersects">Rectangle Intersects</h3>
<p>方形交叉/重叠</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">intersects</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Rectangle</span><span class="p">.</span><span class="nx">intersection</span><span class="p">(</span><span class="nx">rectA</span><span class="p">,</span> <span class="nx">rectB</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">geom</span><span class="p">(</span><span class="nx">intersects</span><span class="p">,</span> <span class="s1">'rgba(255,0,0,1)'</span><span class="p">);</span>
</pre></div>
<h2 id="audio">AUDIO：音频</h2>
<h3 id="audio-sprite-audio-sprite-duration">Audio Sprite/### Audio Sprite Duration</h3>
<p>声音精灵</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="s1">'sfx'</span><span class="p">,</span> <span class="p">[</span> <span class="s1">'assets/audio/SoundEffects/magical_horror_audiosprite.mp3'</span><span class="p">,</span> <span class="s1">'assets/audio/SoundEffects/magical_horror_audiosprite.ogg'</span> <span class="p">]);</span>
<span class="nx">fx</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="s1">'sfx'</span><span class="p">);</span>
<span class="nx">fx</span><span class="p">.</span><span class="nx">allowMultiple</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="c1">//标签名、开始位置、长度</span>
<span class="nx">fx</span><span class="p">.</span><span class="nx">addMarker</span><span class="p">(</span><span class="s1">'alien death'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
<span class="p">......</span>
<span class="nx">fx</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'alien death'</span><span class="p">);</span>
<span class="p">....</span>
<span class="c1">//暂停、继续</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">fx</span><span class="p">.</span><span class="nx">paused</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">fx</span><span class="p">.</span><span class="nx">resume</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="nx">fx</span><span class="p">.</span><span class="nx">pause</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<h3 id="play-music">Play Music</h3>
<p>音量控制</p>
<div class="highlight"><pre><span></span><span class="nx">music</span><span class="p">.</span><span class="nx">mute</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">music</span><span class="p">.</span><span class="nx">volume</span> <span class="o">+=</span> <span class="mf">0.1</span><span class="p">;</span>
</pre></div>
<h3 id="fade-in">Fade In</h3>
<p>音频淡入</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="s1">'boden'</span><span class="p">,</span> <span class="s1">'assets/audio/goaman_intro.mp3'</span><span class="p">);</span>
<span class="nx">music</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="s1">'boden'</span><span class="p">);</span>
<span class="nx">music</span><span class="p">.</span><span class="nx">onDecoded</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">music</span><span class="p">.</span><span class="nx">fadeIn</span><span class="p">(</span><span class="mi">4000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="audio-sprite-json">Audio Sprite Json</h3>
<p>音频JSON数据（代替标签）</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">audioJSON</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">spritemap</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">'alien death'</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">start</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">end</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="nx">loop</span><span class="o">:</span> <span class="kc">false</span>
        <span class="p">},</span>
        <span class="p">......</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">audiosprite</span><span class="p">(</span><span class="s1">'sfx'</span><span class="p">,</span> <span class="s1">'assets/audio/SoundEffects/fx_mixdown.ogg'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">audioJSON</span><span class="p">);</span>
</pre></div>
<h3 id="loop">Loop</h3>
<p>循环</p>
<div class="highlight"><pre><span></span><span class="nx">bass</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="s1">'bass'</span><span class="p">);</span>
<span class="p">......</span>
<span class="nx">sounds</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">bass</span><span class="p">,</span> <span class="nx">drums</span><span class="p">,</span> <span class="nx">percussion</span><span class="p">,</span> <span class="nx">synth1</span><span class="p">,</span> <span class="nx">synth2</span><span class="p">,</span> <span class="nx">top1</span><span class="p">,</span> <span class="nx">top2</span> <span class="p">];</span>
<span class="c1">//  mp3需要解码时间，并且解码完成顺序是不定的</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">sound</span><span class="p">.</span><span class="nx">setDecodedCallback</span><span class="p">(</span><span class="nx">sounds</span><span class="p">,</span> <span class="nx">start</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">sounds</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
    <span class="c1">//整体循环，音量比例0.6</span>
    <span class="nx">bass</span><span class="p">.</span><span class="nx">loopFull</span><span class="p">(</span><span class="mf">0.6</span><span class="p">);</span>
    <span class="nx">bass</span><span class="p">.</span><span class="nx">onLoop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">hasLooped</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="s1">'bass'</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h3 id="remove-sound">Remove Sound</h3>
<p>移除音频</p>
<div class="highlight"><pre><span></span><span class="nx">music</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">removeSound</span><span class="p">(</span><span class="s1">'wizball'</span><span class="p">);</span>
</pre></div>
<h3 id="restart-sound">Restart Sound</h3>
<p>重播</p>
<div class="highlight"><pre><span></span><span class="nx">music</span><span class="p">.</span><span class="nx">restart</span><span class="p">();</span>
</pre></div>
<h3 id="sound-complete">Sound Complete</h3>
<p>完成事件</p>
<div class="highlight"><pre><span></span><span class="nx">explosion</span><span class="p">.</span><span class="nx">onStop</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">soundStopped</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h2 id="video">VIDEO：视频</h2>
<h3 id="alpha-webm">Alpha Webm</h3>
<p>带透明度的Webm视频（谷歌浏览器支持）</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">video</span><span class="p">(</span><span class="s1">'space'</span><span class="p">,</span> <span class="s1">'assets/video/alpha-webm.webm'</span><span class="p">);</span>
<span class="nx">video</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">video</span><span class="p">(</span><span class="s1">'space'</span><span class="p">);</span>
<span class="nx">video</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">video</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
</pre></div>
<h3 id="change-source">Change Source</h3>
<p>改变视频源</p>
<div class="highlight"><pre><span></span><span class="nx">video</span><span class="p">.</span><span class="nx">onPlay</span><span class="p">.</span><span class="nx">addOnce</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//  5秒后切换源</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="nx">changeSource</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">changeSource</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">video</span><span class="p">.</span><span class="nx">changeSource</span><span class="p">(</span><span class="s1">'assets/video/skull.mp4'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="snapshot-blend-mode">Snapshot Blend Mode</h3>
<p>视频快照混色模式</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">takeSnapshot</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">bmd</span><span class="p">.</span><span class="nx">width</span> <span class="o">!==</span> <span class="nx">video</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">bmd</span><span class="p">.</span><span class="nx">height</span> <span class="o">!==</span> <span class="nx">video</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">bmd</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">video</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">video</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">video</span><span class="p">.</span><span class="nx">grab</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">alpha</span><span class="p">.</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">video</span><span class="p">.</span><span class="nx">snapshot</span><span class="p">);</span>
    <span class="nx">bmd</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="s1">'swirl'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">video</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">video</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="s1">'color'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="sprites-sharing-video">Sprites Sharing Video</h3>
<p>精灵分有视频</p>
<div class="highlight"><pre><span></span><span class="nx">group</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">group</span><span class="p">();</span>
<span class="nx">video</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">video</span><span class="p">(</span><span class="s1">'liquid'</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">sprite</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomY</span><span class="p">,</span> <span class="nx">video</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="video-stream">Video Stream</h3>
<p>摄像</p>
<div class="highlight"><pre><span></span><span class="nx">video</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">video</span><span class="p">();</span>
<span class="c1">//  可以使用镜头时</span>
<span class="nx">video</span><span class="p">.</span><span class="nx">onAccess</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">camAllowed</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="c1">//  不能使用镜头时</span>
<span class="nx">video</span><span class="p">.</span><span class="nx">onError</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">camBlocked</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">video</span><span class="p">.</span><span class="nx">startMediaStream</span><span class="p">();</span>
</pre></div>
<h2 id="weapon">WEAPON：武器</h2>
<h3 id="asteroids">Asteroids</h3>
<p>爆破彗星</p>
<div class="highlight"><pre><span></span><span class="c1">//  用图bullet生成30颗子弹的武器</span>
<span class="nx">weapon</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">weapon</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s1">'bullet'</span><span class="p">);</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletKillType</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Weapon</span><span class="p">.</span><span class="nx">KILL_WORLD_BOUNDS</span><span class="p">;</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletSpeed</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">fireRate</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">'ship'</span><span class="p">);</span>
<span class="c1">//追踪</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">trackSprite</span><span class="p">(</span><span class="nx">sprite</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">fire</span><span class="p">();</span>
</pre></div>
<h3 id="asteroids-bullet-wrap">Asteroids Bullet Wrap</h3>
<div class="highlight"><pre><span></span><span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletKillType</span> <span class="o">=</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Weapon</span><span class="p">.</span><span class="nx">KILL_LIFESPAN</span><span class="p">;</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletLifespan</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">;</span>
<span class="c1">//子弹折返</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletWorldWrap</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
<h3 id="bullet-angle-variance">Bullet Angle Variance</h3>
<p>子弹角度变量</p>
<div class="highlight"><pre><span></span><span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletAngleVariance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
<h3 id="bullet-speed-variance">Bullet Speed Variance</h3>
<p>字典速度变量</p>
<div class="highlight"><pre><span></span><span class="nx">weapon</span><span class="p">.</span><span class="nx">bulletSpeedVariance</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
</pre></div>
<h3 id="fire-rate">Fire Rate</h3>
<p>射击速率</p>
<div class="highlight"><pre><span></span><span class="c1">//每60毫秒允许一颗子弹</span>
<span class="nx">weapon</span><span class="p">.</span><span class="nx">fireRate</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
</pre></div>
<h3 id="single-bullet">Single Bullet</h3>
<p>单发</p>
<div class="highlight"><pre><span></span><span class="nx">weapon</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">weapon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'bullet'</span><span class="p">);</span>
</pre></div>
<h2 id="loader">LOADER：文件加载器</h2>
<h3 id="asset-pack">Asset Pack</h3>
<p>载入资源包</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">pack</span><span class="p">(</span><span class="s1">'level1'</span><span class="p">,</span> <span class="s1">'assets/asset-pack1.json'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</pre></div>
<h3 id="check-cache">Check Cache</h3>
<p>检测缓存中是否有某键值</p>
<div class="highlight"><pre><span></span><span class="c1">//   检测是否存在</span>
<span class="kd">let</span> <span class="nx">image</span><span class="o">:</span><span class="nb">Boolean</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">checkImageKey</span><span class="p">(</span><span class="s1">'image'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">text</span><span class="o">:</span><span class="nb">Boolean</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">checkTextKey</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">tilemap</span><span class="o">:</span><span class="nb">Boolean</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">checkTilemapKey</span><span class="p">(</span><span class="s1">'mario'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">audio</span><span class="o">:</span><span class="nb">Boolean</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">checkSoundKey</span><span class="p">(</span><span class="s1">'sfx'</span><span class="p">);</span>
</pre></div>
<h3 id="load-audio">Load Audio</h3>
<p>载入音频文件</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="s1">'boden'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'assets/audio/bodenstaendig_2000_in_rock_4bit.mp3'</span><span class="p">,</span> <span class="s1">'assets/audio/bodenstaendig_2000_in_rock_4bit.ogg'</span><span class="p">]);</span>
<span class="c1">//  如果确定浏览器支持某种文件，可如下：</span>
<span class="c1">// game.load.audio('boden', 'assets/audio/bodenstaendig_2000_in_rock_4bit.mp3');</span>
<span class="nx">music</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">sound</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'boden'</span><span class="p">);</span>
</pre></div>
<h3 id="load-binary-file">Load Binary File</h3>
<p>载入二进制文件</p>
<div class="highlight"><pre><span></span><span class="c1">//  Phaser使用XMLHttpRequest载入二进制文件。如果从域外载入，会有'Access-Control-Allow-Origin'头标记;是原处数据，不需要解码。</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">binary</span><span class="p">(</span><span class="s1">'mod'</span><span class="p">,</span> <span class="s1">'assets/audio/protracker/global_trash_3_v2.mod'</span><span class="p">,</span> <span class="nx">binaryLoadCallback</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">binaryLoadCallback</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//  把文件转换为Uint8Array，并把结果返回给缓存</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getBinary</span><span class="p">(</span><span class="s1">'mod'</span><span class="p">);</span>
    <span class="c1">//   getString在区间内进行文本扫描并返回文本</span>
    <span class="kd">var</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">getString</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="mi">1080</span><span class="p">,</span> <span class="mi">1084</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">"Signature: "</span> <span class="o">+</span> <span class="nx">signature</span><span class="p">,</span> <span class="p">{</span> <span class="nx">fill</span><span class="o">:</span> <span class="s1">'#ffffff'</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
<h3 id="load-bitmap-font">Load Bitmap Font</h3>
<p>载入Bitmap字体（可用BMFont等生成）</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">bitmapFont</span><span class="p">(</span><span class="s1">'desyrel'</span><span class="p">,</span> <span class="s1">'assets/fonts/bitmapFonts/desyrel.png'</span><span class="p">,</span> <span class="s1">'assets/fonts/bitmapFonts/desyrel.xml'</span><span class="p">);</span>
<span class="nx">text</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">bitmapText</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'desyrel'</span><span class="p">,</span><span class="s1">'Bitmap Fonts!'</span><span class="p">,</span><span class="mi">64</span><span class="p">);</span>
</pre></div>
<h3 id="load-events">Load Events</h3>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">onLoadStart</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">loadStart</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">onFileComplete</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">fileComplete</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">onLoadComplete</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">loadComplete</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">fileComplete</span><span class="p">(</span><span class="nx">progress</span><span class="p">,</span> <span class="nx">cacheKey</span><span class="p">,</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">totalLoaded</span><span class="p">,</span> <span class="nx">totalFiles</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">setText</span><span class="p">(</span><span class="s2">"File Complete: "</span> <span class="o">+</span> <span class="nx">progress</span> <span class="o">+</span> <span class="s2">"% - "</span> <span class="o">+</span> <span class="nx">totalLoaded</span> <span class="o">+</span> <span class="s2">" out of "</span> <span class="o">+</span> <span class="nx">totalFiles</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">newImage</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">cacheKey</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="load-image">Load Image</h3>
<p>载入图像</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">image</span><span class="p">(</span><span class="s1">'imageKey'</span><span class="p">,</span> <span class="s1">'assets/sprites/phaser2.png'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'imageKey'</span><span class="p">);</span>
</pre></div>
<h3 id="load-spritesheet">Load Spritesheet</h3>
<p>载入精灵单子</p>
<div class="highlight"><pre><span></span><span class="c1">//Phaser.Game.load.spritesheet(key, url, frameWidth, frameHeight, frameMax, margin, spacing) : Phaser.Loader;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">spritesheet</span><span class="p">(</span><span class="s1">'uniqueKey'</span><span class="p">,</span> <span class="s1">'assets/sprites/metalslug_mummy37x45.png'</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">'uniqueKey'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">);</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'walk'</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="load-starling-atlas">Load Starling Atlas</h3>
<p>载入图集</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlasXML</span><span class="p">(</span><span class="s1">'seacreatures'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/seacreatures.xml'</span><span class="p">);</span>
<span class="nx">jellyfish</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">330</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'seacreatures'</span><span class="p">);</span>
<span class="nx">jellyfish</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'swim'</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Animation</span><span class="p">.</span><span class="nx">generateFrameNames</span><span class="p">(</span><span class="s1">'greenJellyfish'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">jellyfish</span><span class="p">.</span><span class="nx">animations</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="s1">'swim'</span><span class="p">);</span>
</pre></div>
<h3 id="load-text-file">Load Text File</h3>
<p>载入文本文件</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'html'</span><span class="p">,</span> <span class="s1">'http://phaser.io'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getText</span><span class="p">(</span><span class="s1">'html'</span><span class="p">);</span>
<span class="nx">text</span> <span class="o">=</span> <span class="nx">html</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'\n'</span><span class="p">);</span>
</pre></div>
<h3 id="load-json-file">Load Json File</h3>
<p>载入Json文件</p>
<div class="highlight"><pre><span></span><span class="c1">//如果要控制解析，请用load.text；域外载入时有文件头</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s1">'version'</span><span class="p">,</span> <span class="s1">'http://phaser.io/version.json'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">phaserJSON</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s1">'version'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">text2</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">"Name: "</span> <span class="o">+</span> <span class="nx">phaserJSON</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="p">{</span> <span class="nx">fill</span><span class="o">:</span> <span class="s1">'#ffffff'</span> <span class="p">});</span>
</pre></div>
<h3 id="load-texture-atlas">Load Texture Atlas</h3>
<p>载入材质图集</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">atlas</span><span class="p">(</span><span class="s1">'test'</span><span class="p">,</span> <span class="s1">'assets/sprites/atlas_hash_trim.png'</span><span class="p">,</span> <span class="s1">'assets/sprites/atlas_json_array_trim.json'</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Loader</span><span class="p">.</span><span class="nx">TEXTURE_ATLAS_JSON_HASH</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'test'</span><span class="p">);</span>
</pre></div>
<h3 id="load-tilemap-json">Load Tilemap Json</h3>
<p>载入瓷砖地图Json</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">tilemap</span><span class="p">(</span><span class="s1">'mario'</span><span class="p">,</span> <span class="s1">'assets/tilemaps/maps/super_mario.json'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Tilemap</span><span class="p">.</span><span class="nx">TILED_JSON</span><span class="p">);</span>
<span class="nx">map</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">tilemap</span><span class="p">(</span><span class="s1">'mario'</span><span class="p">);</span>
<span class="c1">//Phaser.Tilemap.addTilesetImage(tileset, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid) : Phaser.Tileset;</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addTilesetImage</span><span class="p">(</span><span class="s1">'SuperMarioBros-World1-1'</span><span class="p">,</span> <span class="s1">'tiles'</span><span class="p">);</span>
<span class="nx">layer</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">createLayer</span><span class="p">(</span><span class="s1">'World1'</span><span class="p">);</span>
</pre></div>
<h3 id="load-video">Load Video</h3>
<p>载入视频</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">video</span><span class="p">(</span><span class="s1">'chrome'</span><span class="p">,</span> <span class="s1">'assets/video/chrome.webm'</span><span class="p">);</span>
<span class="nx">video</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">video</span><span class="p">(</span><span class="s1">'chrome'</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">video</span><span class="p">.</span><span class="nx">addToWorld</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">centerY</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nx">video</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</pre></div>
<h3 id="pick-images-from-cache">Pick Images From Cache</h3>
<p>存缓存中拣出图像</p>
<div class="highlight"><pre><span></span><span class="c1">//  返回缓存中的图像键值数组</span>
<span class="kd">let</span> <span class="nx">images</span><span class="o">:</span><span class="nb">Array</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getKeys</span><span class="p">(</span><span class="nx">Phaser</span><span class="p">.</span><span class="nx">Cache</span><span class="p">.</span><span class="nx">IMAGE</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">img</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">pick</span><span class="p">(</span><span class="nx">images</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">tempSprite</span><span class="o">:</span><span class="nx">Sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">(</span><span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomX</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">world</span><span class="p">.</span><span class="nx">randomY</span><span class="p">,</span> <span class="nx">img</span><span class="p">);</span>
</pre></div>
<h2 id="filters">FILTERS：滤镜</h2>
<p>可应用到sprite的WebGL影子/滤镜（shader/filter）</p>
<div class="highlight"><pre><span></span><span class="k">new</span> <span class="nx">Filter</span><span class="p">(</span><span class="nx">game</span><span class="p">,</span> <span class="nx">uniforms</span><span class="p">,</span> <span class="nx">fragmentSrc</span><span class="p">)</span>
<span class="c1">//game：Phaser.Game实例，当前game的引用</span>
<span class="c1">//uniforms：Uniform mappings对象</span>
<span class="c1">//fragmentSrc：Array或者string，fragment shader代码，可以是数组（每行代码作一个元素，加上引号），也可以是string</span>
</pre></div>
<h3 id="blue-dots">Blue Dots</h3>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">shader</span><span class="p">(</span><span class="s1">'blueDots'</span><span class="p">,</span> <span class="s1">'assets/shaders/blue-dots.frag'</span><span class="p">);</span>
<span class="nx">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Filter</span><span class="p">(</span><span class="nx">game</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">game</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">getShader</span><span class="p">(</span><span class="s1">'blueDots'</span><span class="p">));</span>
<span class="nx">filter</span><span class="p">.</span><span class="nx">setResolution</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">);</span>
<span class="nx">sprite</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">sprite</span><span class="p">();</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">filters</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">filter</span> <span class="p">];</span>
<span class="c1">// 在update中：</span>
<span class="nx">filter</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
</pre></div>
<h3 id="blur">Blur</h3>
<p>模糊</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">script</span><span class="p">(</span><span class="s1">'BlurX'</span><span class="p">,</span> <span class="s1">'https://cdn.rawgit.com/photonstorm/phaser/master/v2/filters/BlurX.js'</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">script</span><span class="p">(</span><span class="s1">'BlurY'</span><span class="p">,</span> <span class="s1">'https://cdn.rawgit.com/photonstorm/phaser/master/v2/filters/BlurY.js'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">blurX</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s1">'BlurX'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">blurY</span> <span class="o">=</span> <span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s1">'BlurY'</span><span class="p">);</span>
<span class="nx">blurX</span><span class="p">.</span><span class="nx">blur</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nx">blurY</span><span class="p">.</span><span class="nx">blur</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">sprite</span><span class="p">.</span><span class="nx">filters</span> <span class="o">=</span> <span class="p">[</span><span class="nx">blurX</span><span class="p">,</span> <span class="nx">blurY</span><span class="p">];</span>
</pre></div>
<h2 id="misc">MISC：杂项</h2>
<h3 id="antialias-game">Antialias Game</h3>
<p>抗锯齿</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">transparent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">antialias</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">game</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Game</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">AUTO</span><span class="p">,</span> <span class="s1">'phaser-example'</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">transparent</span><span class="p">,</span> <span class="nx">antialias</span><span class="p">);</span>
</pre></div>
<h3 id="device">Device</h3>
<p>设备</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">render</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Navigator: '</span> <span class="o">+</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'iOS: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">iOS</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Mobile Safari: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">mobileSafari</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">98</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'WebApp: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">webApp</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'nav: '</span> <span class="o">+</span> <span class="nx">navigator</span><span class="p">[</span><span class="s1">'standalone'</span><span class="p">],</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="o">+</span><span class="mi">32</span><span class="p">);</span>
    <span class="nx">game</span><span class="p">.</span><span class="nx">debug</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">'app: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">iOSVersion</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="o">+</span><span class="mi">64</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3 id="game-config">Game Config</h3>
<p>通过对象设置游戏</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">800</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="nx">renderer</span><span class="o">:</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">AUTO</span><span class="p">,</span>
    <span class="nx">parent</span><span class="o">:</span> <span class="s1">'phaser-example'</span><span class="p">,</span>
    <span class="nx">transparent</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">antialias</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">state</span><span class="o">:</span> <span class="k">this</span><span class="p">,</span>
    <span class="nx">scaleMode</span><span class="o">:</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">ScaleManager</span><span class="p">.</span><span class="nx">EXACT_FIT</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">game</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phaser</span><span class="p">.</span><span class="nx">Game</span><span class="p">(</span><span class="nx">conf</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">preload</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">create</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
<h3 id="net">Net</h3>
<p>网络信息</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">getHostName</span><span class="p">()</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">checkDomainName</span><span class="p">(</span><span class="s1">'192'</span><span class="p">)</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">checkDomainName</span><span class="p">(</span><span class="s1">'google.com'</span><span class="p">)</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">updateQueryString</span><span class="p">(</span><span class="s1">'atari'</span><span class="p">,</span> <span class="s1">'520'</span><span class="p">)</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">updateQueryString</span><span class="p">(</span><span class="s1">'amiga'</span><span class="p">,</span> <span class="s1">'1200'</span><span class="p">)</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">getQueryString</span><span class="p">()</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="nx">getQueryString</span><span class="p">(</span><span class="s1">'atari'</span><span class="p">)</span>
</pre></div>
<h3 id="pause-menu">Pause Menu</h3>
<p>暂停游戏</p>
<div class="highlight"><pre><span></span><span class="nx">game</span><span class="p">.</span><span class="nx">paused</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span> <span class="c1">//见### Webcam</span>
</pre></div>
<h3 id="random-generators">Random Generators</h3>
<p>随机数生成器</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">font</span><span class="o">:</span> <span class="s2">"14px Arial"</span><span class="p">,</span> <span class="nx">fill</span><span class="o">:</span> <span class="s2">"#ff0044"</span><span class="p">,</span> <span class="nx">align</span><span class="o">:</span> <span class="s2">"center"</span> <span class="p">};</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">'Integer: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">integer</span><span class="p">(),</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">'Frac: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">frac</span><span class="p">(),</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">'Real: '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">real</span><span class="p">(),</span> <span class="nx">style</span><span class="p">);</span>
<span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="s1">'Integer in Range (100-200): '</span> <span class="o">+</span> <span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">integerInRange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="nx">style</span><span class="p">);</span>
</pre></div>
<h3 id="weighted-pick">Weighted Pick</h3>
<p>加权挑拣</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">rnd</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">rnd</span><span class="p">.</span><span class="nx">weightedPick</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
    <span class="nx">total</span><span class="p">[</span><span class="nx">rnd</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
	
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                TOC
                </li>
                <nav class="toc">
                    <div class="toc">
<ul>
<li><a href="#_1">说明：</a></li>
<li><a href="#basics">BASICS：基础</a><ul>
<li><a href="#01-load-an-image">01 Load An Image</a></li>
<li><a href="#02-click-on-an-image">02 Click On An Image</a></li>
<li><a href="#03-move-an-image">03 Move An Image</a></li>
<li><a href="#04-image-follow-input">04 Image Follow Input</a></li>
<li><a href="#05-load-an-animation">05 Load An Animation</a></li>
<li><a href="#06-render-text">06 Render Text</a></li>
<li><a href="#07-tween-an-image">07 Tween An Image</a></li>
</ul>
</li>
<li><a href="#sprites">SPRITES：精灵</a><ul>
<li><a href="#add-an-image">Add An Image</a></li>
<li><a href="#add-a-sprite">Add A Sprite</a></li>
<li><a href="#sprite-from-bitmapdata">Sprite From Bitmapdata</a></li>
<li><a href="#spritesheet">Spritesheet</a></li>
<li><a href="#anchor">Anchor</a></li>
<li><a href="#move-a-sprite">Move A Sprite</a></li>
<li><a href="#destroy">Destroy</a></li>
<li><a href="#sprite-tint">Sprite Tint</a></li>
<li><a href="#scale-a-sprite">Scale A Sprite</a></li>
<li><a href="#fixed-scale">Fixed Scale</a></li>
<li><a href="#rotate-and-scale">Rotate And Scale</a></li>
<li><a href="#add-several-sprites">Add Several Sprites</a></li>
<li><a href="#child-sprites">Child Sprites</a></li>
<li><a href="#sprite-bounds">Sprite Bounds</a></li>
<li><a href="#out-of-bounds">Out Of Bounds</a></li>
<li><a href="#align-in-rectangle">Align In Rectangle</a></li>
<li><a href="#align-to-rectangle">Align To Rectangle</a></li>
<li><a href="#align-multiple-sprites">Align Multiple Sprites</a></li>
<li><a href="#align-text-to-sprite">Align Text To Sprite</a></li>
<li><a href="#align-within-sprite">Align Within Sprite</a></li>
<li><a href="#collide-world-bounds">Collide World Bounds</a></li>
<li><a href="#dynamic-crop">Dynamic Crop</a></li>
<li><a href="#mask">Mask</a></li>
<li><a href="#overlap-tween-without-physics">Overlap Tween Without Physics</a></li>
<li><a href="#pivot">Pivot</a></li>
<li><a href="#rope">Rope</a></li>
<li><a href="#shared-sprite-textures">Shared Sprite Textures</a></li>
</ul>
</li>
<li><a href="#arcade-physicsarcade">ARCADE PHYSICS：ARCADE物理引擎</a><ul>
<li><a href="#body-enable">Body Enable</a></li>
<li><a href="#gravity">Gravity</a></li>
<li><a href="#bounce">Bounce</a></li>
<li><a href="#bounce-accelerator">Bounce Accelerator</a></li>
<li><a href="#body-debug">Body Debug</a></li>
<li><a href="#circle-body">Circle Body</a></li>
<li><a href="#global-pause">Global Pause</a></li>
<li><a href="#asteroids-movement">Asteroids Movement</a></li>
<li><a href="#angle-to-pointer">Angle To Pointer</a></li>
<li><a href="#multi-angle-to-pointer">Multi Angle To Pointer</a></li>
<li><a href="#angle-between">Angle Between</a></li>
<li><a href="#angular-acceleration">Angular Acceleration</a></li>
<li><a href="#angular-velocity">Angular Velocity</a></li>
<li><a href="#accelerate-to-pointer">Accelerate To Pointer</a></li>
<li><a href="#direct-body-movement">Direct Body Movement</a></li>
<li><a href="#distance-to-pointer">Distance To Pointer</a></li>
<li><a href="#gravity-and-drag">Gravity And Drag</a></li>
<li><a href="#group-vs-group">Group Vs Group</a></li>
<li><a href="#group-vs-self">Group Vs Self</a></li>
<li><a href="#larger-bounding-box">Larger Bounding Box</a></li>
<li><a href="#offset-bounding-box">Offset Bounding Box</a></li>
<li><a href="#move-over-distance">Move Over Distance</a></li>
<li><a href="#move-to-pointer">Move To Pointer</a></li>
<li><a href="#move-towards-object">Move Towards Object</a></li>
<li><a href="#multiball">Multiball</a></li>
<li><a href="#on-collide-event">On Collide Event</a></li>
<li><a href="#one-way-collision">One Way Collision</a></li>
<li><a href="#process-callback">Process Callback</a></li>
<li><a href="#quadtree-collision-infos">Quadtree Collision Infos</a></li>
<li><a href="#sort-direction">Sort Direction</a></li>
<li><a href="#sprite-vs-group">Sprite Vs Group</a></li>
<li><a href="#world-bounds-event">World Bounds Event</a></li>
</ul>
</li>
<li><a href="#input">INPUT：输入</a><ul>
<li><a href="#bounds-rect">Bounds Rect</a></li>
<li><a href="#bounds-sprite">Bounds Sprite</a></li>
<li><a href="#bring-a-child-to-top">Bring A Child To Top</a></li>
<li><a href="#button-destroy">Button Destroy</a></li>
<li><a href="#cursor-key-movement">Cursor Key Movement</a></li>
<li><a href="#custom-candidate-handler">Custom Candidate Handler</a></li>
<li><a href="#down-duration">Down Duration</a></li>
<li><a href="#drag">Drag</a></li>
<li><a href="#drag-event-parameters">Drag Event Parameters</a></li>
<li><a href="#drag-update">Drag Update</a></li>
<li><a href="#drop-limitation">Drop Limitation</a></li>
<li><a href="#gamepad">Gamepad</a></li>
<li><a href="#group-input-events">Group Input Events</a></li>
<li><a href="#ignore-child-input">Ignore Child Input</a></li>
<li><a href="#input-child-priority">Input Child Priority</a></li>
<li><a href="#input-order">Input Order</a></li>
<li><a href="#key">Key</a></li>
<li><a href="#keyboard-hotkeys">Keyboard Hotkeys</a></li>
<li><a href="#keyboard-justpressed">Keyboard Justpressed</a></li>
<li><a href="#motion-lock-horizontal">Motion Lock Horizontal</a></li>
<li><a href="#mouse-buttons">Mouse Buttons</a></li>
<li><a href="#multi-touch">Multi Touch</a></li>
<li><a href="#on-tap">On Tap</a></li>
<li><a href="#out-of-game">Out Of Game</a></li>
<li><a href="#override-default-controls">Override Default Controls</a></li>
<li><a href="#pixel-perfect-click-detection">Pixel Perfect Click Detection</a></li>
<li><a href="#pixelpick-atlas">Pixelpick Atlas</a></li>
<li><a href="#pointer-lock">Pointer Lock</a></li>
<li><a href="#pointer-over">Pointer Over</a></li>
<li><a href="#snap-on-drag">Snap On Drag</a></li>
<li><a href="#virtual-gamecontroller">Virtual Gamecontroller</a></li>
<li><a href="#word-input">Word Input</a></li>
</ul>
</li>
<li><a href="#groups">GROUPS：组</a><ul>
<li><a href="#create-group">Create Group</a></li>
<li><a href="#add-a-sprite-to-group">Add A Sprite To Group</a></li>
<li><a href="#remove-removebetween">Remove ### RemoveBetween</a></li>
<li><a href="#replace">Replace</a></li>
<li><a href="#align-frames-to-grid">Align Frames To Grid</a></li>
<li><a href="#align-sprites-to-grid">Align Sprites To Grid</a></li>
<li><a href="#bring-a-group-to-top">Bring A Group To Top</a></li>
<li><a href="#call-all">Call All</a></li>
<li><a href="#call-all-animations">Call All Animations</a></li>
<li><a href="#call-all-input">Call All Input</a></li>
<li><a href="#create-if-null">Create If Null</a></li>
<li><a href="#depth-sort">Depth Sort</a></li>
<li><a href="#display-order">Display Order</a></li>
<li><a href="#filter-by-property">Filter By Property</a></li>
<li><a href="#for-each">For Each</a></li>
<li><a href="#get-first">Get First</a></li>
<li><a href="#group-transform-rotate">Group Transform Rotate</a></li>
<li><a href="#set-all">Set All</a></li>
<li><a href="#move-to-another-group">Move To Another Group</a></li>
<li><a href="#nested-groups">Nested Groups</a></li>
<li><a href="#recycling">Recycling</a></li>
<li><a href="#sort">Sort</a></li>
<li><a href="#swap-children-in-a-group">Swap Children In A Group</a></li>
</ul>
</li>
<li><a href="#buttons">BUTTONS：按钮</a><ul>
<li><a href="#button-in-a-group">Button In A Group</a></li>
<li><a href="#button-using-texture-atlas">Button Using Texture Atlas</a></li>
<li><a href="#cancel-button">Cancel Button</a></li>
<li><a href="#changing-the-frames">Changing The Frames</a></li>
<li><a href="#disable-button-on-click">Disable Button On Click</a></li>
</ul>
</li>
<li><a href="#tweens">TWEENS：补间动画</a><ul>
<li><a href="#alpha-text">Alpha Text</a></li>
<li><a href="#chained-tweens">Chained Tweens</a></li>
<li><a href="#combined-tweens">Combined Tweens</a></li>
<li><a href="#earthquake">Earthquake</a></li>
<li><a href="#easing">Easing</a></li>
<li><a href="#fading-in-a-sprite">Fading In A Sprite</a></li>
<li><a href="#generate-data">Generate Data</a></li>
<li><a href="#interpolation">INTERPOLATION</a></li>
<li><a href="#pause-tween">Pause Tween</a></li>
<li><a href="#repeat">Repeat</a></li>
<li><a href="#tween-from">Tween From</a></li>
<li><a href="#single-tween-reuse">Single Tween Reuse</a></li>
<li><a href="#tween-array">Tween Array</a></li>
<li><a href="#tween-loop-event">Tween Loop Event</a></li>
<li><a href="#tween-relative">Tween Relative</a></li>
<li><a href="#tween-several-properties">Tween Several Properties</a></li>
<li><a href="#yoyo">Yoyo</a></li>
</ul>
</li>
<li><a href="#animation">ANIMATION：动画</a><ul>
<li><a href="#animation-events">Animation Events</a></li>
<li><a href="#change-frame">Change Frame</a></li>
<li><a href="#change-texture-on-click">Change Texture On Click</a></li>
<li><a href="#creature-dragon">Creature Dragon</a></li>
<li><a href="#load-texture">Load Texture</a></li>
<li><a href="#dynamic-animation">Dynamic Animation</a></li>
<li><a href="#frame-update">Frame Update</a></li>
<li><a href="#group-creation">Group Creation</a></li>
<li><a href="#looped-animation">Looped Animation</a></li>
<li><a href="#sprite-sheet">Sprite Sheet</a></li>
<li><a href="#starling-atlas">Starling Atlas</a></li>
<li><a href="#stop-animation">Stop Animation</a></li>
<li><a href="#two-frame-test">Two Frame Test</a></li>
</ul>
</li>
<li><a href="#particles">PARTICLES：粒子</a><ul>
<li><a href="#auto-scale">Auto Scale</a></li>
<li><a href="#click-burst">Click Burst</a></li>
<li><a href="#collision">Collision</a></li>
<li><a href="#destroy-emitter">Destroy Emitter</a></li>
<li><a href="#emitter-width">Emitter Width</a></li>
<li><a href="#firestarter">Firestarter</a></li>
<li><a href="#flow">Flow</a></li>
<li><a href="#no-rotation">No Rotation</a></li>
<li><a href="#particle-alpha">Particle Alpha</a></li>
<li><a href="#particle-class">Particle Class</a></li>
<li><a href="#particle-scale">Particle Scale</a></li>
<li><a href="#rain">Rain</a></li>
<li><a href="#snow">Snow</a></li>
<li><a href="#when-particles-collide">When Particles Collide</a></li>
</ul>
</li>
<li><a href="#time">TIME：时间</a><ul>
<li><a href="#basic-timed-event">Basic Timed Event</a></li>
<li><a href="#basic-looped-event">BASIC LOOPED EVENT</a></li>
<li><a href="#basic-repeat-event">Basic Repeat Event</a></li>
<li><a href="#custom-timer">Custom Timer</a></li>
<li><a href="#elapsed-seconds">Elapsed Seconds</a></li>
<li><a href="#remove-event">Remove Event</a></li>
<li><a href="#slow-down-time">Slow Down Time</a></li>
</ul>
</li>
<li><a href="#text">TEXT：文本</a><ul>
<li><a href="#text-events">Text Events</a></li>
<li><a href="#text-gradient">Text Gradient</a></li>
<li><a href="#center-text">Center Text</a></li>
<li><a href="#center-text-on-sprite">Center Text On Sprite</a></li>
<li><a href="#word-wrap">Word Wrap</a></li>
<li><a href="#text-line-spacing">Text Line Spacing</a></li>
<li><a href="#text-padding">Text Padding</a></li>
<li><a href="#text-reflect">Text Reflect</a></li>
<li><a href="#text-resolution">Text Resolution</a></li>
<li><a href="#text-shadow">Text Shadow</a></li>
<li><a href="#text-shadow-stroke">Text Shadow Stroke</a></li>
<li><a href="#colored-characters">Colored Characters</a></li>
<li><a href="#text-stroke-with-color">Text Stroke With Color</a></li>
<li><a href="#text-tabs">Text Tabs</a></li>
<li><a href="#text-tabs-from-array">Text Tabs From Array</a></li>
<li><a href="#text-with-physics">Text With Physics</a></li>
<li><a href="#extending-text">Extending Text</a></li>
<li><a href="#google-webfonts">Google Webfonts</a></li>
<li><a href="#bitmap-fonts">Bitmap Fonts</a></li>
<li><a href="#clean-text">Clean Text</a></li>
<li><a href="#bitmapfont-drag">Bitmapfont Drag</a></li>
<li><a href="#bitmaptext-anchor-x">Bitmaptext Anchor X</a></li>
<li><a href="#bitmaptext-max-width">Bitmaptext Max Width</a></li>
<li><a href="#bitmaptext-purge-glyphs">Bitmaptext Purge Glyphs</a></li>
<li><a href="#bitmaptext-with-physics">Bitmaptext With Physics</a></li>
<li><a href="#retro-font-1">Retro Font 1</a></li>
</ul>
</li>
<li><a href="#debug">DEBUG：调试信息</a></li>
<li><a href="#tile-sprites">TILE SPRITES：瓷砖精灵</a><ul>
<li><a href="#tiling-sprite">Tiling Sprite</a></li>
<li><a href="#animated-tiling-sprite">Animated Tiling Sprite</a></li>
<li><a href="#sprite-sheet-tiling-sprite">Sprite Sheet Tiling Sprite</a></li>
<li><a href="#tiling-sprite-atlas">Tiling Sprite Atlas</a></li>
<li><a href="#colliding-with-tiling-sprite">Colliding With Tiling Sprite</a></li>
<li><a href="#tile-sprite-from-animated-sprite">Tile Sprite From Animated Sprite</a></li>
</ul>
</li>
<li><a href="#tilemaps">TILEMAPS：瓷砖地图</a><ul>
<li><a href="#blank-tilemap">Blank Tilemap</a></li>
<li><a href="#create-from-array">Create From Array</a></li>
<li><a href="#create-from-objects">Create From Objects</a></li>
<li><a href="#csv-map">Csv Map</a></li>
<li><a href="#csv-map-collide">Csv Map Collide</a></li>
<li><a href="#csv-map-with-p2">CSV MAP WITH P2</a></li>
<li><a href="#features-test">Features Test</a></li>
<li><a href="#fill-tiles">Fill Tiles</a></li>
<li><a href="#paint-tiles">Paint Tiles</a></li>
<li><a href="#randomise-tiles">Randomise Tiles</a></li>
<li><a href="#replace-tiles">Replace Tiles</a></li>
<li><a href="#swap-tiles">Swap Tiles</a></li>
<li><a href="#resize-map">Resize Map</a></li>
<li><a href="#tile-callbacks">Tile Callbacks</a></li>
<li><a href="#tileset-from-bitmapdata">Tileset From Bitmapdata</a></li>
</ul>
</li>
<li><a href="#camera">CAMERA：镜头</a><ul>
<li><a href="#moving-the-camera">Moving The Camera</a></li>
<li><a href="#basic-follow">Basic Follow</a></li>
<li><a href="#camera-fade">Camera Fade</a></li>
<li><a href="#camera-flash">Camera Flash</a></li>
<li><a href="#camera-shake">Camera Shake</a></li>
<li><a href="#deadzone">Deadzone</a></li>
<li><a href="#fixed-to-camera">Fixed To Camera</a></li>
<li><a href="#follow-styles">Follow Styles</a></li>
</ul>
</li>
<li><a href="#world">WORLD：世界</a><ul>
<li><a href="#fixed-to-camera_1">Fixed To Camera</a></li>
<li><a href="#move-around-world">Move Around World</a></li>
<li><a href="#world-wrap">World Wrap</a></li>
</ul>
</li>
<li><a href="#display">DISPLAY：显示</a><ul>
<li><a href="#circle">Circle</a></li>
<li><a href="#ellips">Ellips</a></li>
<li><a href="#arc">Arc</a></li>
<li><a href="#arcade-physics-graphics-shape">Arcade Physics Graphics Shape</a></li>
<li><a href="#extract-mask">Extract Mask</a></li>
<li><a href="#fullscreen">Fullscreen</a></li>
<li><a href="#game-background-color">Game Background Color</a></li>
<li><a href="#generate-texture-from-graphics">Generate Texture From Graphics</a></li>
<li><a href="#gradient">Gradient</a></li>
<li><a href="#graphics">Graphics</a></li>
<li><a href="#graphics-input-events">Graphics Input Events</a></li>
<li><a href="#hsv-color-wheel">Hsv Color Wheel</a></li>
<li><a href="#pixi-render-texture">Pixi Render Texture</a></li>
<li><a href="#render-texture-image">Render Texture Image</a></li>
<li><a href="#render-crisp">Render Crisp</a></li>
<li><a href="#sprite-shadow">Sprite Shadow</a></li>
<li><a href="#viewport">Viewport</a></li>
</ul>
</li>
<li><a href="#bitmapdatabitmapd">BITMAPDATA：BITMAPD数据</a><ul>
<li><a href="#fastcopy-draw">Fastcopy Draw</a></li>
<li><a href="#copy-bitmapdata">Copy Bitmapdata</a></li>
<li><a href="#copy-pixels">Copy Pixels</a></li>
<li><a href="#draw-sprite">Draw Sprite</a></li>
<li><a href="#alpha-mask">Alpha Mask</a></li>
<li><a href="#atlas">Atlas</a></li>
<li><a href="#cached-bitmapdata">Cached Bitmapdata</a></li>
<li><a href="#draw-atlas-frame">Draw Atlas Frame</a></li>
<li><a href="#draw-full">Draw Full</a></li>
<li><a href="#draw-group">Draw Group</a></li>
<li><a href="#get-pixel">Get Pixel</a></li>
<li><a href="#process-pixels-1">Process Pixels 1</a></li>
<li><a href="#radial-gradient">Radial Gradient</a></li>
<li><a href="#replace-color">Replace Color</a></li>
<li><a href="#set-hsl">Set Hsl</a></li>
<li><a href="#sprite-texture">Sprite Texture</a></li>
<li><a href="#text_1">Text</a></li>
</ul>
</li>
<li><a href="#geometry">GEOMETRY：几何形状</a><ul>
<li><a href="#line">Line</a></li>
<li><a href="#rotate-line">Rotate Line</a></li>
<li><a href="#line-bounds">Line Bounds</a></li>
<li><a href="#center-line">Center Line</a></li>
<li><a href="#centroid">Centroid</a></li>
<li><a href="#circle_1">Circle</a></li>
<li><a href="#circle-random-point">Circle Random Point</a></li>
<li><a href="#line-intersection">Line Intersection</a></li>
<li><a href="#line-midpoint">Line Midpoint</a></li>
<li><a href="#line-reflection">Line Reflection</a></li>
<li><a href="#playing-with-points">Playing With Points</a></li>
<li><a href="#polygon">Polygon</a></li>
<li><a href="#polygon-contains">Polygon Contains</a></li>
<li><a href="#rectangle">Rectangle</a></li>
<li><a href="#rectangle-get-point">Rectangle Get Point</a></li>
<li><a href="#rectangle-intersects">Rectangle Intersects</a></li>
</ul>
</li>
<li><a href="#audio">AUDIO：音频</a><ul>
<li><a href="#audio-sprite-audio-sprite-duration">Audio Sprite/### Audio Sprite Duration</a></li>
<li><a href="#play-music">Play Music</a></li>
<li><a href="#fade-in">Fade In</a></li>
<li><a href="#audio-sprite-json">Audio Sprite Json</a></li>
<li><a href="#loop">Loop</a></li>
<li><a href="#remove-sound">Remove Sound</a></li>
<li><a href="#restart-sound">Restart Sound</a></li>
<li><a href="#sound-complete">Sound Complete</a></li>
</ul>
</li>
<li><a href="#video">VIDEO：视频</a><ul>
<li><a href="#alpha-webm">Alpha Webm</a></li>
<li><a href="#change-source">Change Source</a></li>
<li><a href="#snapshot-blend-mode">Snapshot Blend Mode</a></li>
<li><a href="#sprites-sharing-video">Sprites Sharing Video</a></li>
<li><a href="#video-stream">Video Stream</a></li>
</ul>
</li>
<li><a href="#weapon">WEAPON：武器</a><ul>
<li><a href="#asteroids">Asteroids</a></li>
<li><a href="#asteroids-bullet-wrap">Asteroids Bullet Wrap</a></li>
<li><a href="#bullet-angle-variance">Bullet Angle Variance</a></li>
<li><a href="#bullet-speed-variance">Bullet Speed Variance</a></li>
<li><a href="#fire-rate">Fire Rate</a></li>
<li><a href="#single-bullet">Single Bullet</a></li>
</ul>
</li>
<li><a href="#loader">LOADER：文件加载器</a><ul>
<li><a href="#asset-pack">Asset Pack</a></li>
<li><a href="#check-cache">Check Cache</a></li>
<li><a href="#load-audio">Load Audio</a></li>
<li><a href="#load-binary-file">Load Binary File</a></li>
<li><a href="#load-bitmap-font">Load Bitmap Font</a></li>
<li><a href="#load-events">Load Events</a></li>
<li><a href="#load-image">Load Image</a></li>
<li><a href="#load-spritesheet">Load Spritesheet</a></li>
<li><a href="#load-starling-atlas">Load Starling Atlas</a></li>
<li><a href="#load-text-file">Load Text File</a></li>
<li><a href="#load-json-file">Load Json File</a></li>
<li><a href="#load-texture-atlas">Load Texture Atlas</a></li>
<li><a href="#load-tilemap-json">Load Tilemap Json</a></li>
<li><a href="#load-video">Load Video</a></li>
<li><a href="#pick-images-from-cache">Pick Images From Cache</a></li>
</ul>
</li>
<li><a href="#filters">FILTERS：滤镜</a><ul>
<li><a href="#blue-dots">Blue Dots</a></li>
<li><a href="#blur">Blur</a></li>
</ul>
</li>
<li><a href="#misc">MISC：杂项</a><ul>
<li><a href="#antialias-game">Antialias Game</a></li>
<li><a href="#device">Device</a></li>
<li><a href="#game-config">Game Config</a></li>
<li><a href="#net">Net</a></li>
<li><a href="#pause-menu">Pause Menu</a></li>
<li><a href="#random-generators">Random Generators</a></li>
<li><a href="#weighted-pick">Weighted Pick</a></li>
</ul>
</li>
</ul>
</div>
                </nav>                
            </ul>
            </div>
        
        <hr>

    </div>
        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="/archives.html">Archives</a>
                <li><a href="/tags.html">Tags</a>




            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                <li><a href="/category/bu-kao-si-ji.html">布考斯基</a></li>
                <li><a href="/category/qi-ji-yin-qiao-zhi.html">奇技淫巧志</a></li>
                <li><a href="/category/xi-phaser.html">习Phaser</a></li>
                   
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Links
                </li>
            
                <li><a href="http://www.xiiigame.com/example">拼字游戏</a></li>
            </ul>
            </div>


            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                <li><a href="https://github.com/Fusyong">GitHub</a></li>
                <li><a href="https://www.phaser-china.com/">Phaser小站</a></li>
            </ul>
            </div>
            </div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="">嬉戏实验室</a> &copy; 黄复雄 2018, Powered by <a href="http://getpelican.com/">Pelican</a></p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="/theme/bootstrap-collapse.js"></script>
<script>var _gaq=[['_setAccount','UA-105243279-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
<a href="https://github.com/Fusyong"><img style="position: absolute; top: 40px; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
 
</body>
</html>